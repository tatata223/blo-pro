{"ast":null,"code":"import React,{useState,useEffect}from'react';import toast from'react-hot-toast';import{useAuth}from'../contexts/AuthContext';import{useDebounce}from'../hooks/useDebounce';import{useKeyboardShortcuts}from'../hooks/useKeyboardShortcuts';import Header from'./Header/Header';import Sidebar from'./Sidebar/Sidebar';import NotesGrid from'./Notes/NotesGrid';import NoteEditor from'./Notes/NoteEditor';import TemplatesSection from'./Templates/TemplatesSection';import DeleteModal from'./Modal/DeleteModal';import{notesAPI,foldersAPI,tagsAPI}from'../api/api';import'./NotesApp.css';import{jsx as _jsx,jsxs as _jsxs,Fragment as _Fragment}from\"react/jsx-runtime\";const NotesApp=()=>{const{user,logout,loading:authLoading}=useAuth();const[notes,setNotes]=useState([]);const[folders,setFolders]=useState([]);const[tags,setTags]=useState([]);const[selectedNote,setSelectedNote]=useState(null);const[selectedFolder,setSelectedFolder]=useState(null);const[selectedTags,setSelectedTags]=useState([]);const[searchQuery,setSearchQuery]=useState('');const[showEditor,setShowEditor]=useState(false);const[loading,setLoading]=useState(true);const[error,setError]=useState(null);const[deleteModal,setDeleteModal]=useState({isOpen:false,noteId:null});// Debounce поискового запроса\nconst debouncedSearchQuery=useDebounce(searchQuery,300);// Не загружаем данные, пока не загружен пользователь\nuseEffect(()=>{if(!authLoading&&user){loadData();}// eslint-disable-next-line react-hooks/exhaustive-deps\n},[authLoading,user]);useEffect(()=>{if(!authLoading&&user){loadNotes();}// eslint-disable-next-line react-hooks/exhaustive-deps\n},[selectedFolder,selectedTags,debouncedSearchQuery,authLoading,user]);const loadData=async()=>{try{var _foldersRes$data,_tagsRes$data;setError(null);console.log('Loading folders and tags...');const[foldersRes,tagsRes]=await Promise.all([foldersAPI.getAll(),tagsAPI.getAll()]);const foldersData=Array.isArray(foldersRes.data)?foldersRes.data:((_foldersRes$data=foldersRes.data)===null||_foldersRes$data===void 0?void 0:_foldersRes$data.results)||[];const tagsData=Array.isArray(tagsRes.data)?tagsRes.data:((_tagsRes$data=tagsRes.data)===null||_tagsRes$data===void 0?void 0:_tagsRes$data.results)||[];console.log('Loaded folders:',foldersData.length);console.log('Loaded tags:',tagsData.length);setFolders(foldersData);setTags(tagsData);}catch(error){var _error$response;console.error('Error loading data:',error);console.error('Error response:',error.response);setFolders([]);setTags([]);if(((_error$response=error.response)===null||_error$response===void 0?void 0:_error$response.status)===401){setError('Сессия истекла. Пожалуйста, войдите снова.');}else{toast.error('Ошибка загрузки папок и тегов');}}};const loadNotes=async()=>{try{setLoading(true);setError(null);const params={};if(selectedFolder)params.folder=selectedFolder;if(selectedTags.length>0)params.tags=selectedTags;if(debouncedSearchQuery)params.search=debouncedSearchQuery;const response=await notesAPI.getAll(params);const notesData=response.data.results||response.data||[];setNotes(Array.isArray(notesData)?notesData:[]);}catch(error){var _error$response2;console.error('Error loading notes:',error);setNotes([]);if(((_error$response2=error.response)===null||_error$response2===void 0?void 0:_error$response2.status)===401){setError('Сессия истекла. Пожалуйста, войдите снова.');}else{setError('Ошибка загрузки заметок. Попробуйте обновить страницу.');}}finally{setLoading(false);}};const handleCreateNote=async function(){let noteData=arguments.length>0&&arguments[0]!==undefined?arguments[0]:null;if(noteData){// Если передан noteData (из шаблона), создаем заметку\nif(noteData.id&&noteData.name){// Это шаблон из Sidebar\ntry{const response=await notesAPI.createFromTemplate(noteData.id);toast.success(\"\\u0417\\u0430\\u043C\\u0435\\u0442\\u043A\\u0430 \\\"\".concat(noteData.name,\"\\\" \\u0441\\u043E\\u0437\\u0434\\u0430\\u043D\\u0430 \\u0438\\u0437 \\u0448\\u0430\\u0431\\u043B\\u043E\\u043D\\u0430\"));await loadNotes();if(response&&response.data){setSelectedNote(response.data);setShowEditor(true);}}catch(error){var _error$response3,_error$response3$data;console.error('Error creating note from template:',error);toast.error(((_error$response3=error.response)===null||_error$response3===void 0?void 0:(_error$response3$data=_error$response3.data)===null||_error$response3$data===void 0?void 0:_error$response3$data.error)||'Ошибка при создании заметки из шаблона');}}else if(noteData.formData||noteData.template){// Это данные из TemplateBuilder\ntry{const newNote=await notesAPI.create({title:noteData.title||'Новая заметка',content:noteData.content||'',template:noteData.template});toast.success('Заметка создана из шаблона');await loadNotes();// Открываем созданную заметку в редакторе\nif(newNote&&newNote.data){setSelectedNote(newNote.data);setShowEditor(true);}}catch(error){var _error$response4,_error$response4$data;console.error('Error creating note from template:',error);toast.error(((_error$response4=error.response)===null||_error$response4===void 0?void 0:(_error$response4$data=_error$response4.data)===null||_error$response4$data===void 0?void 0:_error$response4$data.error)||'Ошибка при создании заметки из шаблона');}}else{// Это существующая заметка\nsetSelectedNote(noteData);setShowEditor(true);}}else{// Создаем новую заметку\nsetSelectedNote(null);setShowEditor(true);}};const handleEditNote=note=>{setSelectedNote(note);setShowEditor(true);};const handleSaveNote=async noteData=>{try{if(selectedNote&&selectedNote.id){await notesAPI.update(selectedNote.id,noteData);toast.success('Заметка обновлена');}else{await notesAPI.create(noteData);toast.success('Заметка создана');}await loadNotes();setShowEditor(false);setSelectedNote(null);}catch(error){console.error('Error saving note:',error);toast.error('Ошибка при сохранении заметки');throw error;}};const handleDeleteNote=noteId=>{setDeleteModal({isOpen:true,noteId});};const confirmDelete=async()=>{if(deleteModal.noteId){try{await notesAPI.delete(deleteModal.noteId);await loadNotes();if((selectedNote===null||selectedNote===void 0?void 0:selectedNote.id)===deleteModal.noteId){setShowEditor(false);setSelectedNote(null);}setDeleteModal({isOpen:false,noteId:null});}catch(error){console.error('Error deleting note:',error);setDeleteModal({isOpen:false,noteId:null});}}};const handlePinNote=async noteId=>{try{await notesAPI.pin(noteId);const note=notes.find(n=>n.id===noteId);toast.success(note!==null&&note!==void 0&&note.is_pinned?'Заметка откреплена':'Заметка закреплена');await loadNotes();}catch(error){console.error('Error pinning note:',error);toast.error('Ошибка при изменении статуса заметки');}};// Клавиатурные сокращения\nuseKeyboardShortcuts({'ctrl+n':e=>{e.preventDefault();if(!showEditor){handleCreateNote();}},'ctrl+k':e=>{e.preventDefault();// Фокус на поиск\nconst searchInput=document.querySelector('.search-input');if(searchInput){searchInput.focus();searchInput.select();}},'escape':()=>{if(showEditor){setShowEditor(false);setSelectedNote(null);}if(deleteModal.isOpen){setDeleteModal({isOpen:false,noteId:null});}}},[showEditor,deleteModal,handleCreateNote]);// Показываем загрузку, если еще загружается аутентификация\nif(authLoading||!user){return/*#__PURE__*/_jsxs(\"div\",{style:{display:'flex',flexDirection:'column',justifyContent:'center',alignItems:'center',height:'100vh',fontSize:'17px',color:'var(--text-secondary)',background:'var(--bg-color)'},children:[/*#__PURE__*/_jsx(\"div\",{style:{width:'40px',height:'40px',border:'3px solid var(--border-color)',borderTopColor:'var(--primary-color)',borderRadius:'50%',animation:'spin 1s linear infinite',marginBottom:'16px'}}),/*#__PURE__*/_jsx(\"style\",{children:\"\\n          @keyframes spin {\\n            to { transform: rotate(360deg); }\\n          }\\n        \"}),\"\\u0417\\u0430\\u0433\\u0440\\u0443\\u0437\\u043A\\u0430...\"]});}return/*#__PURE__*/_jsxs(\"div\",{className:\"notes-app\",children:[/*#__PURE__*/_jsx(Header,{user:user,onLogout:logout,searchQuery:searchQuery,onSearchChange:setSearchQuery,onCreateNote:handleCreateNote}),/*#__PURE__*/_jsxs(\"div\",{className:\"notes-app-content\",children:[/*#__PURE__*/_jsx(Sidebar,{folders:folders,tags:tags,selectedFolder:selectedFolder,selectedTags:selectedTags,onFolderSelect:setSelectedFolder,onTagSelect:setSelectedTags,onFolderCreate:loadData,onTagCreate:loadData,loading:loading&&folders.length===0}),/*#__PURE__*/_jsxs(\"div\",{className:\"notes-main\",children:[error&&/*#__PURE__*/_jsxs(\"div\",{className:\"error-banner\",children:[/*#__PURE__*/_jsx(\"span\",{children:error}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>{setError(null);loadNotes();},children:\"\\u041E\\u0431\\u043D\\u043E\\u0432\\u0438\\u0442\\u044C\"})]}),showEditor?/*#__PURE__*/_jsx(NoteEditor,{note:selectedNote,folders:folders,tags:tags,onSave:handleSaveNote,onCancel:()=>{setShowEditor(false);setSelectedNote(null);}}):/*#__PURE__*/_jsx(_Fragment,{children:/*#__PURE__*/_jsx(NotesGrid,{notes:notes,loading:loading,onEdit:handleEditNote,onDelete:handleDeleteNote,onPin:handlePinNote})})]})]}),/*#__PURE__*/_jsx(DeleteModal,{isOpen:deleteModal.isOpen,onClose:()=>setDeleteModal({isOpen:false,noteId:null}),onConfirm:confirmDelete,title:\"\\u0423\\u0434\\u0430\\u043B\\u0435\\u043D\\u0438\\u0435 \\u0437\\u0430\\u043C\\u0435\\u0442\\u043A\\u0438\",message:\"\\u0412\\u044B \\u0443\\u0432\\u0435\\u0440\\u0435\\u043D\\u044B, \\u0447\\u0442\\u043E \\u0445\\u043E\\u0442\\u0438\\u0442\\u0435 \\u0443\\u0434\\u0430\\u043B\\u0438\\u0442\\u044C \\u044D\\u0442\\u0443 \\u0437\\u0430\\u043C\\u0435\\u0442\\u043A\\u0443? \\u042D\\u0442\\u043E \\u0434\\u0435\\u0439\\u0441\\u0442\\u0432\\u0438\\u0435 \\u043D\\u0435\\u043B\\u044C\\u0437\\u044F \\u043E\\u0442\\u043C\\u0435\\u043D\\u0438\\u0442\\u044C.\"})]});};export default NotesApp;","map":{"version":3,"names":["React","useState","useEffect","toast","useAuth","useDebounce","useKeyboardShortcuts","Header","Sidebar","NotesGrid","NoteEditor","TemplatesSection","DeleteModal","notesAPI","foldersAPI","tagsAPI","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","NotesApp","user","logout","loading","authLoading","notes","setNotes","folders","setFolders","tags","setTags","selectedNote","setSelectedNote","selectedFolder","setSelectedFolder","selectedTags","setSelectedTags","searchQuery","setSearchQuery","showEditor","setShowEditor","setLoading","error","setError","deleteModal","setDeleteModal","isOpen","noteId","debouncedSearchQuery","loadData","loadNotes","_foldersRes$data","_tagsRes$data","console","log","foldersRes","tagsRes","Promise","all","getAll","foldersData","Array","isArray","data","results","tagsData","length","_error$response","response","status","params","folder","search","notesData","_error$response2","handleCreateNote","noteData","arguments","undefined","id","name","createFromTemplate","success","concat","_error$response3","_error$response3$data","formData","template","newNote","create","title","content","_error$response4","_error$response4$data","handleEditNote","note","handleSaveNote","update","handleDeleteNote","confirmDelete","delete","handlePinNote","pin","find","n","is_pinned","e","preventDefault","searchInput","document","querySelector","focus","select","escape","style","display","flexDirection","justifyContent","alignItems","height","fontSize","color","background","children","width","border","borderTopColor","borderRadius","animation","marginBottom","className","onLogout","onSearchChange","onCreateNote","onFolderSelect","onTagSelect","onFolderCreate","onTagCreate","onClick","onSave","onCancel","onEdit","onDelete","onPin","onClose","onConfirm","message"],"sources":["/Users/mikhail/Downloads/ЗаметкиPARADIZE/frontend/src/components/NotesApp.js"],"sourcesContent":["import React, { useState, useEffect } from 'react';\nimport toast from 'react-hot-toast';\nimport { useAuth } from '../contexts/AuthContext';\nimport { useDebounce } from '../hooks/useDebounce';\nimport { useKeyboardShortcuts } from '../hooks/useKeyboardShortcuts';\nimport Header from './Header/Header';\nimport Sidebar from './Sidebar/Sidebar';\nimport NotesGrid from './Notes/NotesGrid';\nimport NoteEditor from './Notes/NoteEditor';\nimport TemplatesSection from './Templates/TemplatesSection';\nimport DeleteModal from './Modal/DeleteModal';\nimport { notesAPI, foldersAPI, tagsAPI } from '../api/api';\nimport './NotesApp.css';\n\nconst NotesApp = () => {\n  const { user, logout, loading: authLoading } = useAuth();\n  const [notes, setNotes] = useState([]);\n  const [folders, setFolders] = useState([]);\n  const [tags, setTags] = useState([]);\n  const [selectedNote, setSelectedNote] = useState(null);\n  const [selectedFolder, setSelectedFolder] = useState(null);\n  const [selectedTags, setSelectedTags] = useState([]);\n  const [searchQuery, setSearchQuery] = useState('');\n  const [showEditor, setShowEditor] = useState(false);\n  const [loading, setLoading] = useState(true);\n  const [error, setError] = useState(null);\n  const [deleteModal, setDeleteModal] = useState({ isOpen: false, noteId: null });\n\n  // Debounce поискового запроса\n  const debouncedSearchQuery = useDebounce(searchQuery, 300);\n\n  // Не загружаем данные, пока не загружен пользователь\n  useEffect(() => {\n    if (!authLoading && user) {\n      loadData();\n    }\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [authLoading, user]);\n\n  useEffect(() => {\n    if (!authLoading && user) {\n      loadNotes();\n    }\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [selectedFolder, selectedTags, debouncedSearchQuery, authLoading, user]);\n\n  const loadData = async () => {\n    try {\n      setError(null);\n      console.log('Loading folders and tags...');\n      const [foldersRes, tagsRes] = await Promise.all([\n        foldersAPI.getAll(),\n        tagsAPI.getAll(),\n      ]);\n      \n      const foldersData = Array.isArray(foldersRes.data) ? foldersRes.data : \n                         (foldersRes.data?.results || []);\n      const tagsData = Array.isArray(tagsRes.data) ? tagsRes.data : \n                      (tagsRes.data?.results || []);\n      \n      console.log('Loaded folders:', foldersData.length);\n      console.log('Loaded tags:', tagsData.length);\n      \n      setFolders(foldersData);\n      setTags(tagsData);\n    } catch (error) {\n      console.error('Error loading data:', error);\n      console.error('Error response:', error.response);\n      setFolders([]);\n      setTags([]);\n      if (error.response?.status === 401) {\n        setError('Сессия истекла. Пожалуйста, войдите снова.');\n      } else {\n        toast.error('Ошибка загрузки папок и тегов');\n      }\n    }\n  };\n\n  const loadNotes = async () => {\n    try {\n      setLoading(true);\n      setError(null);\n      const params = {};\n      if (selectedFolder) params.folder = selectedFolder;\n      if (selectedTags.length > 0) params.tags = selectedTags;\n      if (debouncedSearchQuery) params.search = debouncedSearchQuery;\n      \n      const response = await notesAPI.getAll(params);\n      const notesData = response.data.results || response.data || [];\n      setNotes(Array.isArray(notesData) ? notesData : []);\n    } catch (error) {\n      console.error('Error loading notes:', error);\n      setNotes([]);\n      if (error.response?.status === 401) {\n        setError('Сессия истекла. Пожалуйста, войдите снова.');\n      } else {\n        setError('Ошибка загрузки заметок. Попробуйте обновить страницу.');\n      }\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const handleCreateNote = async (noteData = null) => {\n    if (noteData) {\n      // Если передан noteData (из шаблона), создаем заметку\n      if (noteData.id && noteData.name) {\n        // Это шаблон из Sidebar\n        try {\n          const response = await notesAPI.createFromTemplate(noteData.id);\n          toast.success(`Заметка \"${noteData.name}\" создана из шаблона`);\n          await loadNotes();\n          if (response && response.data) {\n            setSelectedNote(response.data);\n            setShowEditor(true);\n          }\n        } catch (error) {\n          console.error('Error creating note from template:', error);\n          toast.error(error.response?.data?.error || 'Ошибка при создании заметки из шаблона');\n        }\n      } else if (noteData.formData || noteData.template) {\n        // Это данные из TemplateBuilder\n        try {\n          const newNote = await notesAPI.create({\n            title: noteData.title || 'Новая заметка',\n            content: noteData.content || '',\n            template: noteData.template\n          });\n          toast.success('Заметка создана из шаблона');\n          await loadNotes();\n          // Открываем созданную заметку в редакторе\n          if (newNote && newNote.data) {\n            setSelectedNote(newNote.data);\n            setShowEditor(true);\n          }\n        } catch (error) {\n          console.error('Error creating note from template:', error);\n          toast.error(error.response?.data?.error || 'Ошибка при создании заметки из шаблона');\n        }\n      } else {\n        // Это существующая заметка\n        setSelectedNote(noteData);\n        setShowEditor(true);\n      }\n    } else {\n      // Создаем новую заметку\n      setSelectedNote(null);\n      setShowEditor(true);\n    }\n  };\n\n  const handleEditNote = (note) => {\n    setSelectedNote(note);\n    setShowEditor(true);\n  };\n\n  const handleSaveNote = async (noteData) => {\n    try {\n      if (selectedNote && selectedNote.id) {\n        await notesAPI.update(selectedNote.id, noteData);\n        toast.success('Заметка обновлена');\n      } else {\n        await notesAPI.create(noteData);\n        toast.success('Заметка создана');\n      }\n      await loadNotes();\n      setShowEditor(false);\n      setSelectedNote(null);\n    } catch (error) {\n      console.error('Error saving note:', error);\n      toast.error('Ошибка при сохранении заметки');\n      throw error;\n    }\n  };\n\n  const handleDeleteNote = (noteId) => {\n    setDeleteModal({ isOpen: true, noteId });\n  };\n\n  const confirmDelete = async () => {\n    if (deleteModal.noteId) {\n      try {\n        await notesAPI.delete(deleteModal.noteId);\n        await loadNotes();\n        if (selectedNote?.id === deleteModal.noteId) {\n          setShowEditor(false);\n          setSelectedNote(null);\n        }\n        setDeleteModal({ isOpen: false, noteId: null });\n      } catch (error) {\n        console.error('Error deleting note:', error);\n        setDeleteModal({ isOpen: false, noteId: null });\n      }\n    }\n  };\n\n  const handlePinNote = async (noteId) => {\n    try {\n      await notesAPI.pin(noteId);\n      const note = notes.find(n => n.id === noteId);\n      toast.success(note?.is_pinned ? 'Заметка откреплена' : 'Заметка закреплена');\n      await loadNotes();\n    } catch (error) {\n      console.error('Error pinning note:', error);\n      toast.error('Ошибка при изменении статуса заметки');\n    }\n  };\n\n  // Клавиатурные сокращения\n  useKeyboardShortcuts({\n    'ctrl+n': (e) => {\n      e.preventDefault();\n      if (!showEditor) {\n        handleCreateNote();\n      }\n    },\n    'ctrl+k': (e) => {\n      e.preventDefault();\n      // Фокус на поиск\n      const searchInput = document.querySelector('.search-input');\n      if (searchInput) {\n        searchInput.focus();\n        searchInput.select();\n      }\n    },\n    'escape': () => {\n      if (showEditor) {\n        setShowEditor(false);\n        setSelectedNote(null);\n      }\n      if (deleteModal.isOpen) {\n        setDeleteModal({ isOpen: false, noteId: null });\n      }\n    },\n  }, [showEditor, deleteModal, handleCreateNote]);\n\n  // Показываем загрузку, если еще загружается аутентификация\n  if (authLoading || !user) {\n    return (\n      <div style={{ \n        display: 'flex', \n        flexDirection: 'column',\n        justifyContent: 'center', \n        alignItems: 'center', \n        height: '100vh',\n        fontSize: '17px',\n        color: 'var(--text-secondary)',\n        background: 'var(--bg-color)'\n      }}>\n        <div style={{\n          width: '40px',\n          height: '40px',\n          border: '3px solid var(--border-color)',\n          borderTopColor: 'var(--primary-color)',\n          borderRadius: '50%',\n          animation: 'spin 1s linear infinite',\n          marginBottom: '16px'\n        }}></div>\n        <style>{`\n          @keyframes spin {\n            to { transform: rotate(360deg); }\n          }\n        `}</style>\n        Загрузка...\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"notes-app\">\n      <Header\n        user={user}\n        onLogout={logout}\n        searchQuery={searchQuery}\n        onSearchChange={setSearchQuery}\n        onCreateNote={handleCreateNote}\n      />\n      <div className=\"notes-app-content\">\n        <Sidebar\n          folders={folders}\n          tags={tags}\n          selectedFolder={selectedFolder}\n          selectedTags={selectedTags}\n          onFolderSelect={setSelectedFolder}\n          onTagSelect={setSelectedTags}\n          onFolderCreate={loadData}\n          onTagCreate={loadData}\n          loading={loading && folders.length === 0}\n        />\n        <div className=\"notes-main\">\n          {error && (\n            <div className=\"error-banner\">\n              <span>{error}</span>\n              <button onClick={() => { setError(null); loadNotes(); }}>Обновить</button>\n            </div>\n          )}\n          {showEditor ? (\n            <NoteEditor\n              note={selectedNote}\n              folders={folders}\n              tags={tags}\n              onSave={handleSaveNote}\n              onCancel={() => {\n                setShowEditor(false);\n                setSelectedNote(null);\n              }}\n            />\n          ) : (\n            <>\n              <NotesGrid\n                notes={notes}\n                loading={loading}\n                onEdit={handleEditNote}\n                onDelete={handleDeleteNote}\n                onPin={handlePinNote}\n              />\n            </>\n          )}\n        </div>\n      </div>\n      <DeleteModal\n        isOpen={deleteModal.isOpen}\n        onClose={() => setDeleteModal({ isOpen: false, noteId: null })}\n        onConfirm={confirmDelete}\n        title=\"Удаление заметки\"\n        message=\"Вы уверены, что хотите удалить эту заметку? Это действие нельзя отменить.\"\n      />\n    </div>\n  );\n};\n\nexport default NotesApp;\n\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}