{"ast":null,"code":"import React,{useState,useEffect}from'react';import{useAuth}from'../contexts/AuthContext';import Header from'./Header/Header';import Sidebar from'./Sidebar/Sidebar';import NotesGrid from'./Notes/NotesGrid';import NoteEditor from'./Notes/NoteEditor';import TemplatesSection from'./Templates/TemplatesSection';import{notesAPI,foldersAPI,tagsAPI}from'../api/api';import'./NotesApp.css';import{jsx as _jsx,Fragment as _Fragment,jsxs as _jsxs}from\"react/jsx-runtime\";const NotesApp=()=>{const{user,logout}=useAuth();const[notes,setNotes]=useState([]);const[folders,setFolders]=useState([]);const[tags,setTags]=useState([]);const[selectedNote,setSelectedNote]=useState(null);const[selectedFolder,setSelectedFolder]=useState(null);const[selectedTags,setSelectedTags]=useState([]);const[searchQuery,setSearchQuery]=useState('');const[showEditor,setShowEditor]=useState(false);const[loading,setLoading]=useState(true);useEffect(()=>{loadData();// eslint-disable-next-line react-hooks/exhaustive-deps\n},[]);useEffect(()=>{loadNotes();// eslint-disable-next-line react-hooks/exhaustive-deps\n},[selectedFolder,selectedTags,searchQuery]);const loadData=async()=>{try{const[foldersRes,tagsRes]=await Promise.all([foldersAPI.getAll(),tagsAPI.getAll()]);setFolders(foldersRes.data);setTags(tagsRes.data);}catch(error){console.error('Error loading data:',error);}};const loadNotes=async()=>{try{setLoading(true);const params={};if(selectedFolder)params.folder=selectedFolder;if(selectedTags.length>0)params.tags=selectedTags;if(searchQuery)params.search=searchQuery;const response=await notesAPI.getAll(params);setNotes(response.data.results||response.data);}catch(error){console.error('Error loading notes:',error);}finally{setLoading(false);}};const handleCreateNote=function(){let noteData=arguments.length>0&&arguments[0]!==undefined?arguments[0]:null;if(noteData){// Если передан noteData (из шаблона), редактируем его\nsetSelectedNote(noteData);}else{// Создаем новую заметку\nsetSelectedNote(null);}setShowEditor(true);};const handleEditNote=note=>{setSelectedNote(note);setShowEditor(true);};const handleSaveNote=async noteData=>{try{if(selectedNote&&selectedNote.id){await notesAPI.update(selectedNote.id,noteData);}else{await notesAPI.create(noteData);}await loadNotes();setShowEditor(false);setSelectedNote(null);}catch(error){console.error('Error saving note:',error);throw error;}};const handleDeleteNote=async noteId=>{if(window.confirm('Вы уверены, что хотите удалить эту заметку?')){try{await notesAPI.delete(noteId);await loadNotes();if((selectedNote===null||selectedNote===void 0?void 0:selectedNote.id)===noteId){setShowEditor(false);setSelectedNote(null);}}catch(error){console.error('Error deleting note:',error);}}};const handlePinNote=async noteId=>{try{await notesAPI.pin(noteId);await loadNotes();}catch(error){console.error('Error pinning note:',error);}};return/*#__PURE__*/_jsxs(\"div\",{className:\"notes-app\",children:[/*#__PURE__*/_jsx(Header,{user:user,onLogout:logout,searchQuery:searchQuery,onSearchChange:setSearchQuery,onCreateNote:handleCreateNote}),/*#__PURE__*/_jsxs(\"div\",{className:\"notes-app-content\",children:[/*#__PURE__*/_jsx(Sidebar,{folders:folders,tags:tags,selectedFolder:selectedFolder,selectedTags:selectedTags,onFolderSelect:setSelectedFolder,onTagSelect:setSelectedTags,onFolderCreate:loadData,onTagCreate:loadData}),/*#__PURE__*/_jsx(\"div\",{className:\"notes-main\",children:showEditor?/*#__PURE__*/_jsx(NoteEditor,{note:selectedNote,folders:folders,tags:tags,onSave:handleSaveNote,onCancel:()=>{setShowEditor(false);setSelectedNote(null);}}):/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(NotesGrid,{notes:notes,loading:loading,onEdit:handleEditNote,onDelete:handleDeleteNote,onPin:handlePinNote}),/*#__PURE__*/_jsx(TemplatesSection,{onTemplateSelect:handleCreateNote})]})})]})]});};export default NotesApp;","map":{"version":3,"names":["React","useState","useEffect","useAuth","Header","Sidebar","NotesGrid","NoteEditor","TemplatesSection","notesAPI","foldersAPI","tagsAPI","jsx","_jsx","Fragment","_Fragment","jsxs","_jsxs","NotesApp","user","logout","notes","setNotes","folders","setFolders","tags","setTags","selectedNote","setSelectedNote","selectedFolder","setSelectedFolder","selectedTags","setSelectedTags","searchQuery","setSearchQuery","showEditor","setShowEditor","loading","setLoading","loadData","loadNotes","foldersRes","tagsRes","Promise","all","getAll","data","error","console","params","folder","length","search","response","results","handleCreateNote","noteData","arguments","undefined","handleEditNote","note","handleSaveNote","id","update","create","handleDeleteNote","noteId","window","confirm","delete","handlePinNote","pin","className","children","onLogout","onSearchChange","onCreateNote","onFolderSelect","onTagSelect","onFolderCreate","onTagCreate","onSave","onCancel","onEdit","onDelete","onPin","onTemplateSelect"],"sources":["/Users/mikhail/Downloads/ЗаметкиPARADIZE/frontend/src/components/NotesApp.js"],"sourcesContent":["import React, { useState, useEffect } from 'react';\nimport { useAuth } from '../contexts/AuthContext';\nimport Header from './Header/Header';\nimport Sidebar from './Sidebar/Sidebar';\nimport NotesGrid from './Notes/NotesGrid';\nimport NoteEditor from './Notes/NoteEditor';\nimport TemplatesSection from './Templates/TemplatesSection';\nimport { notesAPI, foldersAPI, tagsAPI } from '../api/api';\nimport './NotesApp.css';\n\nconst NotesApp = () => {\n  const { user, logout } = useAuth();\n  const [notes, setNotes] = useState([]);\n  const [folders, setFolders] = useState([]);\n  const [tags, setTags] = useState([]);\n  const [selectedNote, setSelectedNote] = useState(null);\n  const [selectedFolder, setSelectedFolder] = useState(null);\n  const [selectedTags, setSelectedTags] = useState([]);\n  const [searchQuery, setSearchQuery] = useState('');\n  const [showEditor, setShowEditor] = useState(false);\n  const [loading, setLoading] = useState(true);\n\n  useEffect(() => {\n    loadData();\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, []);\n\n  useEffect(() => {\n    loadNotes();\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [selectedFolder, selectedTags, searchQuery]);\n\n  const loadData = async () => {\n    try {\n      const [foldersRes, tagsRes] = await Promise.all([\n        foldersAPI.getAll(),\n        tagsAPI.getAll(),\n      ]);\n      setFolders(foldersRes.data);\n      setTags(tagsRes.data);\n    } catch (error) {\n      console.error('Error loading data:', error);\n    }\n  };\n\n  const loadNotes = async () => {\n    try {\n      setLoading(true);\n      const params = {};\n      if (selectedFolder) params.folder = selectedFolder;\n      if (selectedTags.length > 0) params.tags = selectedTags;\n      if (searchQuery) params.search = searchQuery;\n      \n      const response = await notesAPI.getAll(params);\n      setNotes(response.data.results || response.data);\n    } catch (error) {\n      console.error('Error loading notes:', error);\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const handleCreateNote = (noteData = null) => {\n    if (noteData) {\n      // Если передан noteData (из шаблона), редактируем его\n      setSelectedNote(noteData);\n    } else {\n      // Создаем новую заметку\n      setSelectedNote(null);\n    }\n    setShowEditor(true);\n  };\n\n  const handleEditNote = (note) => {\n    setSelectedNote(note);\n    setShowEditor(true);\n  };\n\n  const handleSaveNote = async (noteData) => {\n    try {\n      if (selectedNote && selectedNote.id) {\n        await notesAPI.update(selectedNote.id, noteData);\n      } else {\n        await notesAPI.create(noteData);\n      }\n      await loadNotes();\n      setShowEditor(false);\n      setSelectedNote(null);\n    } catch (error) {\n      console.error('Error saving note:', error);\n      throw error;\n    }\n  };\n\n  const handleDeleteNote = async (noteId) => {\n    if (window.confirm('Вы уверены, что хотите удалить эту заметку?')) {\n      try {\n        await notesAPI.delete(noteId);\n        await loadNotes();\n        if (selectedNote?.id === noteId) {\n          setShowEditor(false);\n          setSelectedNote(null);\n        }\n      } catch (error) {\n        console.error('Error deleting note:', error);\n      }\n    }\n  };\n\n  const handlePinNote = async (noteId) => {\n    try {\n      await notesAPI.pin(noteId);\n      await loadNotes();\n    } catch (error) {\n      console.error('Error pinning note:', error);\n    }\n  };\n\n  return (\n    <div className=\"notes-app\">\n      <Header\n        user={user}\n        onLogout={logout}\n        searchQuery={searchQuery}\n        onSearchChange={setSearchQuery}\n        onCreateNote={handleCreateNote}\n      />\n      <div className=\"notes-app-content\">\n        <Sidebar\n          folders={folders}\n          tags={tags}\n          selectedFolder={selectedFolder}\n          selectedTags={selectedTags}\n          onFolderSelect={setSelectedFolder}\n          onTagSelect={setSelectedTags}\n          onFolderCreate={loadData}\n          onTagCreate={loadData}\n        />\n        <div className=\"notes-main\">\n          {showEditor ? (\n            <NoteEditor\n              note={selectedNote}\n              folders={folders}\n              tags={tags}\n              onSave={handleSaveNote}\n              onCancel={() => {\n                setShowEditor(false);\n                setSelectedNote(null);\n              }}\n            />\n          ) : (\n            <>\n              <NotesGrid\n                notes={notes}\n                loading={loading}\n                onEdit={handleEditNote}\n                onDelete={handleDeleteNote}\n                onPin={handlePinNote}\n              />\n              <TemplatesSection onTemplateSelect={handleCreateNote} />\n            </>\n          )}\n        </div>\n      </div>\n    </div>\n  );\n};\n\nexport default NotesApp;\n\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}