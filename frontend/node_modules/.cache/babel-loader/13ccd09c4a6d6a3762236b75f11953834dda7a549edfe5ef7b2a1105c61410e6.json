{"ast":null,"code":"import React,{useState,useEffect,useRef}from'react';import{chatAPI}from'../../api/api';import{useAuth}from'../../contexts/AuthContext';import toast from'react-hot-toast';import'./ChatWindow.css';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const ChatWindow=_ref=>{let{room,onNewMessage,currentUser}=_ref;const[messages,setMessages]=useState([]);const[newMessage,setNewMessage]=useState('');const[selectedFile,setSelectedFile]=useState(null);const[loading,setLoading]=useState(true);const messagesEndRef=useRef(null);const inputRef=useRef(null);const fileInputRef=useRef(null);const pollingIntervalRef=useRef(null);useEffect(()=>{if(room!==null&&room!==void 0&&room.id){loadMessages();// Запускаем polling для обновления сообщений каждые 2 секунды\npollingIntervalRef.current=setInterval(()=>{loadMessages();},2000);}return()=>{if(pollingIntervalRef.current){clearInterval(pollingIntervalRef.current);}};},[room===null||room===void 0?void 0:room.id]);useEffect(()=>{scrollToBottom();},[messages]);const loadMessages=async()=>{try{const response=await chatAPI.getMessages(room.id);const newMessages=response.data.reverse();// Обновляем только если есть новые сообщения\nsetMessages(prev=>{var _prev,_newMessages;if(prev.length!==newMessages.length||((_prev=prev[prev.length-1])===null||_prev===void 0?void 0:_prev.id)!==((_newMessages=newMessages[newMessages.length-1])===null||_newMessages===void 0?void 0:_newMessages.id)){return newMessages;}return prev;});}catch(error){console.error('Error loading messages:',error);if(loading){toast.error('Ошибка загрузки сообщений');}}finally{setLoading(false);}};const handleFileSelect=e=>{const file=e.target.files[0];if(file){if(file.size>10*1024*1024){toast.error('Размер файла не должен превышать 10 МБ');return;}setSelectedFile(file);}};const handleSendMessage=async e=>{e.preventDefault();if(!newMessage.trim()&&!selectedFile)return;const messageContent=newMessage.trim();setNewMessage('');try{const formData=new FormData();if(messageContent){formData.append('content',messageContent);}if(selectedFile){formData.append('file',selectedFile);formData.append('message_type',selectedFile.type.startsWith('image/')?'image':'file');}await chatAPI.sendMessage(room.id,formData,true);setSelectedFile(null);if(fileInputRef.current){fileInputRef.current.value='';}// Обновляем сообщения сразу после отправки\nawait loadMessages();onNewMessage();}catch(error){console.error('Error sending message:',error);toast.error('Ошибка отправки сообщения');setNewMessage(messageContent);// Восстанавливаем текст\n}};const scrollToBottom=()=>{var _messagesEndRef$curre;(_messagesEndRef$curre=messagesEndRef.current)===null||_messagesEndRef$curre===void 0?void 0:_messagesEndRef$curre.scrollIntoView({behavior:'smooth'});};if(loading){return/*#__PURE__*/_jsx(\"div\",{className:\"chat-window\",children:/*#__PURE__*/_jsx(\"div\",{className:\"chat-window-loading\",children:\"\\u0417\\u0430\\u0433\\u0440\\u0443\\u0437\\u043A\\u0430 \\u0441\\u043E\\u043E\\u0431\\u0449\\u0435\\u043D\\u0438\\u0439...\"})});}return/*#__PURE__*/_jsxs(\"div\",{className:\"chat-window\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"chat-window-header\",children:[/*#__PURE__*/_jsx(\"h3\",{children:room.display_name}),/*#__PURE__*/_jsx(\"div\",{className:\"chat-window-meta\",children:room.members_count&&/*#__PURE__*/_jsxs(\"span\",{children:[room.members_count,\" \\u0443\\u0447\\u0430\\u0441\\u0442\\u043D\\u0438\\u043A\\u043E\\u0432\"]})})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"chat-window-messages\",children:[messages.length===0?/*#__PURE__*/_jsxs(\"div\",{className:\"chat-window-empty\",children:[/*#__PURE__*/_jsx(\"p\",{children:\"\\u041D\\u0435\\u0442 \\u0441\\u043E\\u043E\\u0431\\u0449\\u0435\\u043D\\u0438\\u0439\"}),/*#__PURE__*/_jsx(\"p\",{className:\"chat-window-empty-hint\",children:\"\\u041D\\u0430\\u0447\\u043D\\u0438\\u0442\\u0435 \\u043E\\u0431\\u0449\\u0435\\u043D\\u0438\\u0435, \\u043E\\u0442\\u043F\\u0440\\u0430\\u0432\\u0438\\u0432 \\u043F\\u0435\\u0440\\u0432\\u043E\\u0435 \\u0441\\u043E\\u043E\\u0431\\u0449\\u0435\\u043D\\u0438\\u0435\"})]}):messages.map(message=>/*#__PURE__*/_jsxs(\"div\",{className:\"chat-message \".concat(message.sender.id===(currentUser===null||currentUser===void 0?void 0:currentUser.id)?'own':''),children:[message.sender.id!==(currentUser===null||currentUser===void 0?void 0:currentUser.id)&&/*#__PURE__*/_jsx(\"div\",{className:\"chat-message-avatar\",children:message.sender.username[0].toUpperCase()}),/*#__PURE__*/_jsxs(\"div\",{className:\"chat-message-content\",children:[message.sender.id!==(currentUser===null||currentUser===void 0?void 0:currentUser.id)&&/*#__PURE__*/_jsx(\"div\",{className:\"chat-message-sender\",children:message.sender.username}),/*#__PURE__*/_jsxs(\"div\",{className:\"chat-message-bubble\",children:[message.content,message.file&&/*#__PURE__*/_jsx(\"div\",{className:\"chat-message-file\",children:/*#__PURE__*/_jsxs(\"a\",{href:message.file,target:\"_blank\",rel:\"noopener noreferrer\",className:\"chat-file-link\",children:[/*#__PURE__*/_jsxs(\"svg\",{width:\"16\",height:\"16\",viewBox:\"0 0 24 24\",fill:\"none\",xmlns:\"http://www.w3.org/2000/svg\",style:{display:'inline-block',marginRight:'6px',verticalAlign:'middle'},children:[/*#__PURE__*/_jsx(\"path\",{d:\"M14 2H6C5.46957 2 4.96086 2.21071 4.58579 2.58579C4.21071 2.96086 4 3.46957 4 4V20C4 20.5304 4.21071 21.0391 4.58579 21.4142C4.96086 21.7893 5.46957 22 6 22H18C18.5304 22 19.0391 21.7893 19.4142 21.4142C19.7893 21.0391 20 20.5304 20 20V8L14 2Z\",stroke:\"currentColor\",strokeWidth:\"2\",strokeLinecap:\"round\",strokeLinejoin:\"round\"}),/*#__PURE__*/_jsx(\"path\",{d:\"M14 2V8H20\",stroke:\"currentColor\",strokeWidth:\"2\",strokeLinecap:\"round\",strokeLinejoin:\"round\"})]}),message.file_name||'Файл']})})]}),/*#__PURE__*/_jsx(\"div\",{className:\"chat-message-time\",children:new Date(message.created_at).toLocaleTimeString('ru-RU',{hour:'2-digit',minute:'2-digit'})})]})]},message.id)),/*#__PURE__*/_jsx(\"div\",{ref:messagesEndRef})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"chat-window-input\",children:[selectedFile&&/*#__PURE__*/_jsxs(\"div\",{className:\"chat-file-preview\",children:[/*#__PURE__*/_jsx(\"span\",{children:selectedFile.name}),/*#__PURE__*/_jsx(\"button\",{type:\"button\",onClick:()=>{setSelectedFile(null);if(fileInputRef.current)fileInputRef.current.value='';},className:\"chat-file-remove\",children:/*#__PURE__*/_jsx(\"svg\",{width:\"18\",height:\"18\",viewBox:\"0 0 24 24\",fill:\"none\",xmlns:\"http://www.w3.org/2000/svg\",children:/*#__PURE__*/_jsx(\"path\",{d:\"M18 6L6 18M6 6L18 18\",stroke:\"currentColor\",strokeWidth:\"2.5\",strokeLinecap:\"round\",strokeLinejoin:\"round\"})})})]}),/*#__PURE__*/_jsxs(\"form\",{onSubmit:handleSendMessage,style:{display:'flex',gap:'12px',alignItems:'center'},children:[/*#__PURE__*/_jsx(\"input\",{ref:fileInputRef,type:\"file\",onChange:handleFileSelect,style:{display:'none'}}),/*#__PURE__*/_jsx(\"button\",{type:\"button\",onClick:()=>{var _fileInputRef$current;return(_fileInputRef$current=fileInputRef.current)===null||_fileInputRef$current===void 0?void 0:_fileInputRef$current.click();},className:\"chat-attach-btn\",title:\"\\u041F\\u0440\\u0438\\u043A\\u0440\\u0435\\u043F\\u0438\\u0442\\u044C \\u0444\\u0430\\u0439\\u043B\",children:/*#__PURE__*/_jsx(\"svg\",{width:\"20\",height:\"20\",viewBox:\"0 0 24 24\",fill:\"none\",xmlns:\"http://www.w3.org/2000/svg\",children:/*#__PURE__*/_jsx(\"path\",{d:\"M21.44 11.05L12.25 20.24C11.1242 21.3658 9.59718 21.9983 8.005 21.9983C6.41282 21.9983 4.88584 21.3658 3.76 20.24C2.63416 19.1142 2.00171 17.5872 2.00171 15.995C2.00171 14.4028 2.63416 12.8758 3.76 11.75L12.95 2.56C13.7006 1.80944 14.7186 1.38778 15.78 1.38778C16.8414 1.38778 17.8594 1.80944 18.61 2.56C19.3606 3.31056 19.7822 4.32856 19.7822 5.39C19.7822 6.45144 19.3606 7.46944 18.61 8.22L9.41 17.41C9.03473 17.7853 8.52573 17.9961 7.995 17.9961C7.46427 17.9961 6.95527 17.7853 6.58 17.41C6.20473 17.0347 5.99393 16.5257 5.99393 15.995C5.99393 15.4643 6.20473 14.9553 6.58 14.58L15.07 6.09\",stroke:\"currentColor\",strokeWidth:\"2\",strokeLinecap:\"round\",strokeLinejoin:\"round\"})})}),/*#__PURE__*/_jsx(\"input\",{ref:inputRef,type:\"text\",value:newMessage,onChange:e=>setNewMessage(e.target.value),placeholder:\"\\u0412\\u0432\\u0435\\u0434\\u0438\\u0442\\u0435 \\u0441\\u043E\\u043E\\u0431\\u0449\\u0435\\u043D\\u0438\\u0435...\",className:\"chat-input\"}),/*#__PURE__*/_jsx(\"button\",{type:\"submit\",className:\"chat-send-btn\",disabled:!newMessage.trim()&&!selectedFile,children:/*#__PURE__*/_jsx(\"svg\",{width:\"20\",height:\"20\",viewBox:\"0 0 24 24\",fill:\"none\",xmlns:\"http://www.w3.org/2000/svg\",children:/*#__PURE__*/_jsx(\"path\",{d:\"M22 2L11 13M22 2L15 22L11 13M22 2L2 9L11 13\",stroke:\"currentColor\",strokeWidth:\"2\",strokeLinecap:\"round\",strokeLinejoin:\"round\"})})})]})]})]});};export default ChatWindow;","map":{"version":3,"names":["React","useState","useEffect","useRef","chatAPI","useAuth","toast","jsx","_jsx","jsxs","_jsxs","ChatWindow","_ref","room","onNewMessage","currentUser","messages","setMessages","newMessage","setNewMessage","selectedFile","setSelectedFile","loading","setLoading","messagesEndRef","inputRef","fileInputRef","pollingIntervalRef","id","loadMessages","current","setInterval","clearInterval","scrollToBottom","response","getMessages","newMessages","data","reverse","prev","_prev","_newMessages","length","error","console","handleFileSelect","e","file","target","files","size","handleSendMessage","preventDefault","trim","messageContent","formData","FormData","append","type","startsWith","sendMessage","value","_messagesEndRef$curre","scrollIntoView","behavior","className","children","display_name","members_count","map","message","concat","sender","username","toUpperCase","content","href","rel","width","height","viewBox","fill","xmlns","style","display","marginRight","verticalAlign","d","stroke","strokeWidth","strokeLinecap","strokeLinejoin","file_name","Date","created_at","toLocaleTimeString","hour","minute","ref","name","onClick","onSubmit","gap","alignItems","onChange","_fileInputRef$current","click","title","placeholder","disabled"],"sources":["/Users/mikhail/Downloads/ЗаметкиPARADIZE/frontend/src/components/Chat/ChatWindow.js"],"sourcesContent":["import React, { useState, useEffect, useRef } from 'react';\nimport { chatAPI } from '../../api/api';\nimport { useAuth } from '../../contexts/AuthContext';\nimport toast from 'react-hot-toast';\nimport './ChatWindow.css';\n\nconst ChatWindow = ({ room, onNewMessage, currentUser }) => {\n  const [messages, setMessages] = useState([]);\n  const [newMessage, setNewMessage] = useState('');\n  const [selectedFile, setSelectedFile] = useState(null);\n  const [loading, setLoading] = useState(true);\n  const messagesEndRef = useRef(null);\n  const inputRef = useRef(null);\n  const fileInputRef = useRef(null);\n  const pollingIntervalRef = useRef(null);\n\n  useEffect(() => {\n    if (room?.id) {\n      loadMessages();\n      // Запускаем polling для обновления сообщений каждые 2 секунды\n      pollingIntervalRef.current = setInterval(() => {\n        loadMessages();\n      }, 2000);\n    }\n\n    return () => {\n      if (pollingIntervalRef.current) {\n        clearInterval(pollingIntervalRef.current);\n      }\n    };\n  }, [room?.id]);\n\n  useEffect(() => {\n    scrollToBottom();\n  }, [messages]);\n\n  const loadMessages = async () => {\n    try {\n      const response = await chatAPI.getMessages(room.id);\n      const newMessages = response.data.reverse();\n      // Обновляем только если есть новые сообщения\n      setMessages(prev => {\n        if (prev.length !== newMessages.length || \n            prev[prev.length - 1]?.id !== newMessages[newMessages.length - 1]?.id) {\n          return newMessages;\n        }\n        return prev;\n      });\n    } catch (error) {\n      console.error('Error loading messages:', error);\n      if (loading) {\n        toast.error('Ошибка загрузки сообщений');\n      }\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const handleFileSelect = (e) => {\n    const file = e.target.files[0];\n    if (file) {\n      if (file.size > 10 * 1024 * 1024) {\n        toast.error('Размер файла не должен превышать 10 МБ');\n        return;\n      }\n      setSelectedFile(file);\n    }\n  };\n\n  const handleSendMessage = async (e) => {\n    e.preventDefault();\n    if (!newMessage.trim() && !selectedFile) return;\n\n    const messageContent = newMessage.trim();\n    setNewMessage('');\n\n    try {\n      const formData = new FormData();\n      if (messageContent) {\n        formData.append('content', messageContent);\n      }\n      if (selectedFile) {\n        formData.append('file', selectedFile);\n        formData.append('message_type', selectedFile.type.startsWith('image/') ? 'image' : 'file');\n      }\n\n      await chatAPI.sendMessage(room.id, formData, true);\n      \n      setSelectedFile(null);\n      if (fileInputRef.current) {\n        fileInputRef.current.value = '';\n      }\n      \n      // Обновляем сообщения сразу после отправки\n      await loadMessages();\n      onNewMessage();\n    } catch (error) {\n      console.error('Error sending message:', error);\n      toast.error('Ошибка отправки сообщения');\n      setNewMessage(messageContent); // Восстанавливаем текст\n    }\n  };\n\n  const scrollToBottom = () => {\n    messagesEndRef.current?.scrollIntoView({ behavior: 'smooth' });\n  };\n\n  if (loading) {\n    return (\n      <div className=\"chat-window\">\n        <div className=\"chat-window-loading\">Загрузка сообщений...</div>\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"chat-window\">\n      <div className=\"chat-window-header\">\n        <h3>{room.display_name}</h3>\n        <div className=\"chat-window-meta\">\n          {room.members_count && (\n            <span>{room.members_count} участников</span>\n          )}\n        </div>\n      </div>\n\n      <div className=\"chat-window-messages\">\n        {messages.length === 0 ? (\n          <div className=\"chat-window-empty\">\n            <p>Нет сообщений</p>\n            <p className=\"chat-window-empty-hint\">Начните общение, отправив первое сообщение</p>\n          </div>\n        ) : (\n          messages.map(message => (\n            <div\n              key={message.id}\n              className={`chat-message ${message.sender.id === currentUser?.id ? 'own' : ''}`}\n            >\n              {message.sender.id !== currentUser?.id && (\n                <div className=\"chat-message-avatar\">\n                  {message.sender.username[0].toUpperCase()}\n                </div>\n              )}\n              <div className=\"chat-message-content\">\n                {message.sender.id !== currentUser?.id && (\n                  <div className=\"chat-message-sender\">{message.sender.username}</div>\n                )}\n                <div className=\"chat-message-bubble\">\n                  {message.content}\n                  {message.file && (\n                    <div className=\"chat-message-file\">\n                      <a \n                        href={message.file} \n                        target=\"_blank\" \n                        rel=\"noopener noreferrer\"\n                        className=\"chat-file-link\"\n                      >\n                        <svg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\" style={{ display: 'inline-block', marginRight: '6px', verticalAlign: 'middle' }}>\n                          <path d=\"M14 2H6C5.46957 2 4.96086 2.21071 4.58579 2.58579C4.21071 2.96086 4 3.46957 4 4V20C4 20.5304 4.21071 21.0391 4.58579 21.4142C4.96086 21.7893 5.46957 22 6 22H18C18.5304 22 19.0391 21.7893 19.4142 21.4142C19.7893 21.0391 20 20.5304 20 20V8L14 2Z\" stroke=\"currentColor\" strokeWidth=\"2\" strokeLinecap=\"round\" strokeLinejoin=\"round\"/>\n                          <path d=\"M14 2V8H20\" stroke=\"currentColor\" strokeWidth=\"2\" strokeLinecap=\"round\" strokeLinejoin=\"round\"/>\n                        </svg>\n                        {message.file_name || 'Файл'}\n                      </a>\n                    </div>\n                  )}\n                </div>\n                <div className=\"chat-message-time\">\n                  {new Date(message.created_at).toLocaleTimeString('ru-RU', {\n                    hour: '2-digit',\n                    minute: '2-digit'\n                  })}\n                </div>\n              </div>\n            </div>\n          ))\n        )}\n        <div ref={messagesEndRef} />\n      </div>\n\n      <div className=\"chat-window-input\">\n        {selectedFile && (\n          <div className=\"chat-file-preview\">\n            <span>{selectedFile.name}</span>\n            <button \n              type=\"button\" \n              onClick={() => {\n                setSelectedFile(null);\n                if (fileInputRef.current) fileInputRef.current.value = '';\n              }}\n              className=\"chat-file-remove\"\n            >\n              <svg width=\"18\" height=\"18\" viewBox=\"0 0 24 24\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\">\n                <path d=\"M18 6L6 18M6 6L18 18\" stroke=\"currentColor\" strokeWidth=\"2.5\" strokeLinecap=\"round\" strokeLinejoin=\"round\"/>\n              </svg>\n            </button>\n          </div>\n        )}\n        <form onSubmit={handleSendMessage} style={{ display: 'flex', gap: '12px', alignItems: 'center' }}>\n          <input\n            ref={fileInputRef}\n            type=\"file\"\n            onChange={handleFileSelect}\n            style={{ display: 'none' }}\n          />\n          <button \n            type=\"button\" \n            onClick={() => fileInputRef.current?.click()}\n            className=\"chat-attach-btn\"\n            title=\"Прикрепить файл\"\n          >\n            <svg width=\"20\" height=\"20\" viewBox=\"0 0 24 24\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\">\n              <path d=\"M21.44 11.05L12.25 20.24C11.1242 21.3658 9.59718 21.9983 8.005 21.9983C6.41282 21.9983 4.88584 21.3658 3.76 20.24C2.63416 19.1142 2.00171 17.5872 2.00171 15.995C2.00171 14.4028 2.63416 12.8758 3.76 11.75L12.95 2.56C13.7006 1.80944 14.7186 1.38778 15.78 1.38778C16.8414 1.38778 17.8594 1.80944 18.61 2.56C19.3606 3.31056 19.7822 4.32856 19.7822 5.39C19.7822 6.45144 19.3606 7.46944 18.61 8.22L9.41 17.41C9.03473 17.7853 8.52573 17.9961 7.995 17.9961C7.46427 17.9961 6.95527 17.7853 6.58 17.41C6.20473 17.0347 5.99393 16.5257 5.99393 15.995C5.99393 15.4643 6.20473 14.9553 6.58 14.58L15.07 6.09\" stroke=\"currentColor\" strokeWidth=\"2\" strokeLinecap=\"round\" strokeLinejoin=\"round\"/>\n            </svg>\n          </button>\n          <input\n            ref={inputRef}\n            type=\"text\"\n            value={newMessage}\n            onChange={(e) => setNewMessage(e.target.value)}\n            placeholder=\"Введите сообщение...\"\n            className=\"chat-input\"\n          />\n          <button type=\"submit\" className=\"chat-send-btn\" disabled={!newMessage.trim() && !selectedFile}>\n            <svg width=\"20\" height=\"20\" viewBox=\"0 0 24 24\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\">\n              <path d=\"M22 2L11 13M22 2L15 22L11 13M22 2L2 9L11 13\" stroke=\"currentColor\" strokeWidth=\"2\" strokeLinecap=\"round\" strokeLinejoin=\"round\"/>\n            </svg>\n          </button>\n        </form>\n      </div>\n    </div>\n  );\n};\n\nexport default ChatWindow;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}