{"ast":null,"code":"import React,{useState,useEffect}from'react';import{chatAPI}from'../../api/api';import{useAuth}from'../../contexts/AuthContext';import ChatList from'./ChatList';import ChatWindow from'./ChatWindow';import Layout from'../Layout/Layout';import'./ChatInterface.css';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const ChatInterface=()=>{const{user}=useAuth();const[rooms,setRooms]=useState([]);const[selectedRoom,setSelectedRoom]=useState(null);const[loading,setLoading]=useState(true);useEffect(()=>{loadRooms();},[]);const loadRooms=async()=>{try{const response=await chatAPI.getRooms();setRooms(response.data);}catch(error){console.error('Error loading chat rooms:',error);}finally{setLoading(false);}};const handleSelectRoom=room=>{setSelectedRoom(room);// Отмечаем сообщения как прочитанные\nif(room.id){chatAPI.markAsRead(room.id).catch(console.error);}};const handleCreateRoom=async function(userIds){let roomType=arguments.length>1&&arguments[1]!==undefined?arguments[1]:'direct';try{const response=await chatAPI.createRoom({user_ids:userIds,room_type:roomType});const newRoom=response.data;setRooms([newRoom,...rooms]);setSelectedRoom(newRoom);}catch(error){console.error('Error creating chat room:',error);throw error;}};const handleNewMessage=()=>{// Обновляем список комнат при новом сообщении\nloadRooms();};if(loading){return/*#__PURE__*/_jsx(Layout,{children:/*#__PURE__*/_jsx(\"div\",{className:\"chat-loading\",children:\"\\u0417\\u0430\\u0433\\u0440\\u0443\\u0437\\u043A\\u0430 \\u0447\\u0430\\u0442\\u043E\\u0432...\"})});}return/*#__PURE__*/_jsx(Layout,{children:/*#__PURE__*/_jsxs(\"div\",{className:\"chat-interface\",children:[/*#__PURE__*/_jsx(ChatList,{rooms:rooms,selectedRoom:selectedRoom,onSelectRoom:handleSelectRoom,onCreateRoom:handleCreateRoom,currentUser:user}),selectedRoom?/*#__PURE__*/_jsx(ChatWindow,{room:selectedRoom,onNewMessage:handleNewMessage,currentUser:user}):/*#__PURE__*/_jsxs(\"div\",{className:\"chat-placeholder\",children:[/*#__PURE__*/_jsx(\"svg\",{width:\"64\",height:\"64\",viewBox:\"0 0 24 24\",fill:\"none\",xmlns:\"http://www.w3.org/2000/svg\",children:/*#__PURE__*/_jsx(\"path\",{d:\"M21 15C21 15.5304 20.7893 16.0391 20.4142 16.4142C20.0391 16.7893 19.5304 17 19 17H7L3 21V5C3 4.46957 3.21071 3.96086 3.58579 3.58579C3.96086 3.21071 4.46957 3 5 3H19C19.5304 3 20.0391 3.21071 20.4142 3.58579C20.7893 3.96086 21 4.46957 21 5V15Z\",stroke:\"currentColor\",strokeWidth:\"2\",strokeLinecap:\"round\",strokeLinejoin:\"round\"})}),/*#__PURE__*/_jsx(\"p\",{children:\"\\u0412\\u044B\\u0431\\u0435\\u0440\\u0438\\u0442\\u0435 \\u0447\\u0430\\u0442 \\u0434\\u043B\\u044F \\u043D\\u0430\\u0447\\u0430\\u043B\\u0430 \\u043E\\u0431\\u0449\\u0435\\u043D\\u0438\\u044F\"})]})]})});};export default ChatInterface;","map":{"version":3,"names":["React","useState","useEffect","chatAPI","useAuth","ChatList","ChatWindow","Layout","jsx","_jsx","jsxs","_jsxs","ChatInterface","user","rooms","setRooms","selectedRoom","setSelectedRoom","loading","setLoading","loadRooms","response","getRooms","data","error","console","handleSelectRoom","room","id","markAsRead","catch","handleCreateRoom","userIds","roomType","arguments","length","undefined","createRoom","user_ids","room_type","newRoom","handleNewMessage","children","className","onSelectRoom","onCreateRoom","currentUser","onNewMessage","width","height","viewBox","fill","xmlns","d","stroke","strokeWidth","strokeLinecap","strokeLinejoin"],"sources":["/Users/mikhail/Downloads/ЗаметкиPARADIZE/frontend/src/components/Chat/ChatInterface.js"],"sourcesContent":["import React, { useState, useEffect } from 'react';\nimport { chatAPI } from '../../api/api';\nimport { useAuth } from '../../contexts/AuthContext';\nimport ChatList from './ChatList';\nimport ChatWindow from './ChatWindow';\nimport Layout from '../Layout/Layout';\nimport './ChatInterface.css';\n\nconst ChatInterface = () => {\n  const { user } = useAuth();\n  const [rooms, setRooms] = useState([]);\n  const [selectedRoom, setSelectedRoom] = useState(null);\n  const [loading, setLoading] = useState(true);\n\n  useEffect(() => {\n    loadRooms();\n  }, []);\n\n  const loadRooms = async () => {\n    try {\n      const response = await chatAPI.getRooms();\n      setRooms(response.data);\n    } catch (error) {\n      console.error('Error loading chat rooms:', error);\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const handleSelectRoom = (room) => {\n    setSelectedRoom(room);\n    // Отмечаем сообщения как прочитанные\n    if (room.id) {\n      chatAPI.markAsRead(room.id).catch(console.error);\n    }\n  };\n\n  const handleCreateRoom = async (userIds, roomType = 'direct') => {\n    try {\n      const response = await chatAPI.createRoom({\n        user_ids: userIds,\n        room_type: roomType,\n      });\n      const newRoom = response.data;\n      setRooms([newRoom, ...rooms]);\n      setSelectedRoom(newRoom);\n    } catch (error) {\n      console.error('Error creating chat room:', error);\n      throw error;\n    }\n  };\n\n  const handleNewMessage = () => {\n    // Обновляем список комнат при новом сообщении\n    loadRooms();\n  };\n\n  if (loading) {\n    return (\n      <Layout>\n        <div className=\"chat-loading\">Загрузка чатов...</div>\n      </Layout>\n    );\n  }\n\n  return (\n    <Layout>\n      <div className=\"chat-interface\">\n      <ChatList\n        rooms={rooms}\n        selectedRoom={selectedRoom}\n        onSelectRoom={handleSelectRoom}\n        onCreateRoom={handleCreateRoom}\n        currentUser={user}\n      />\n      {selectedRoom ? (\n        <ChatWindow\n          room={selectedRoom}\n          onNewMessage={handleNewMessage}\n          currentUser={user}\n        />\n      ) : (\n        <div className=\"chat-placeholder\">\n          <svg width=\"64\" height=\"64\" viewBox=\"0 0 24 24\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\">\n            <path d=\"M21 15C21 15.5304 20.7893 16.0391 20.4142 16.4142C20.0391 16.7893 19.5304 17 19 17H7L3 21V5C3 4.46957 3.21071 3.96086 3.58579 3.58579C3.96086 3.21071 4.46957 3 5 3H19C19.5304 3 20.0391 3.21071 20.4142 3.58579C20.7893 3.96086 21 4.46957 21 5V15Z\" stroke=\"currentColor\" strokeWidth=\"2\" strokeLinecap=\"round\" strokeLinejoin=\"round\"/>\n          </svg>\n          <p>Выберите чат для начала общения</p>\n        </div>\n      )}\n      </div>\n    </Layout>\n  );\n};\n\nexport default ChatInterface;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}