{"ast":null,"code":"import _objectSpread from\"/Users/mikhail/Downloads/blo-pro/frontend/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import React,{useState,useEffect}from'react';import toast from'react-hot-toast';import{useAuth}from'../contexts/AuthContext';import{useDebounce}from'../hooks/useDebounce';import{useKeyboardShortcuts}from'../hooks/useKeyboardShortcuts';import Header from'./Header/Header';import Sidebar from'./Sidebar/Sidebar';import NotesGrid from'./Notes/NotesGrid';import NoteEditor from'./Notes/NoteEditor';import TemplateBuilder from'./Templates/TemplateBuilder';import DeleteModal from'./Modal/DeleteModal';import AuthModal from'./Auth/AuthModal';import{notesAPI,foldersAPI,tagsAPI}from'../api/api';import'./NotesApp.css';import{jsx as _jsx,jsxs as _jsxs,Fragment as _Fragment}from\"react/jsx-runtime\";const NotesApp=()=>{const{user,logout,loading:authLoading}=useAuth();const[notes,setNotes]=useState([]);const[folders,setFolders]=useState([]);const[tags,setTags]=useState([]);const[selectedNote,setSelectedNote]=useState(null);const[selectedFolder,setSelectedFolder]=useState(null);const[selectedTags,setSelectedTags]=useState([]);const[searchQuery,setSearchQuery]=useState('');const[showEditor,setShowEditor]=useState(false);const[loading,setLoading]=useState(true);const[error,setError]=useState(null);const[deleteModal,setDeleteModal]=useState({isOpen:false,noteId:null});const[selectedTemplate,setSelectedTemplate]=useState(null);const[showTemplateBuilder,setShowTemplateBuilder]=useState(false);const[isInitialLoad,setIsInitialLoad]=useState(true);const[showAuthModal,setShowAuthModal]=useState(false);const[pendingNoteData,setPendingNoteData]=useState(null);const[isSidebarOpen,setIsSidebarOpen]=useState(false);const[isSearchOpen,setIsSearchOpen]=useState(false);// Debounce поискового запроса\nconst debouncedSearchQuery=useDebounce(searchQuery,300);// Guest mode helpers\nconst getGuestNotes=()=>{try{const stored=localStorage.getItem('guest_notes');return stored?JSON.parse(stored):[];}catch(_unused){return[];}};const getGuestFolders=()=>{try{const stored=localStorage.getItem('guest_folders');return stored?JSON.parse(stored):[];}catch(_unused2){return[];}};const getGuestTags=()=>{try{const stored=localStorage.getItem('guest_tags');return stored?JSON.parse(stored):[];}catch(_unused3){return[];}};const saveGuestNote=note=>{const guestNotes=getGuestNotes();if(guestNotes.length>=1&&!note.id){toast.error('Для создания больше заметок необходимо зарегистрироваться');setShowAuthModal(true);return false;}const updatedNotes=note.id?guestNotes.map(n=>n.id===note.id?_objectSpread(_objectSpread({},note),{},{id:note.id}):n):[...guestNotes,_objectSpread(_objectSpread({},note),{},{id:\"guest_\".concat(Date.now())})];localStorage.setItem('guest_notes',JSON.stringify(updatedNotes));return true;};const saveGuestFolder=folder=>{const guestFolders=getGuestFolders();if(guestFolders.length>=1&&!folder.id){toast.error('Для создания больше папок необходимо зарегистрироваться');setShowAuthModal(true);return false;}const updatedFolders=folder.id?guestFolders.map(f=>f.id===folder.id?folder:f):[...guestFolders,_objectSpread(_objectSpread({},folder),{},{id:\"guest_\".concat(Date.now())})];localStorage.setItem('guest_folders',JSON.stringify(updatedFolders));return true;};const saveGuestTag=tag=>{const guestTags=getGuestTags();if(guestTags.length>=1&&!tag.id){toast.error('Для создания больше тегов необходимо зарегистрироваться');setShowAuthModal(true);return false;}const updatedTags=tag.id?guestTags.map(t=>t.id===tag.id?tag:t):[...guestTags,_objectSpread(_objectSpread({},tag),{},{id:\"guest_\".concat(Date.now())})];localStorage.setItem('guest_tags',JSON.stringify(updatedTags));return true;};const transferGuestData=async()=>{const guestNotes=getGuestNotes();const guestFolders=getGuestFolders();const guestTags=getGuestTags();try{// Transfer folders\nfor(const folder of guestFolders){try{await foldersAPI.create({name:folder.name,color:folder.color});}catch(error){console.error('Error transferring folder:',error);}}// Transfer tags\nfor(const tag of guestTags){try{await tagsAPI.create({name:tag.name,color:tag.color});}catch(error){console.error('Error transferring tag:',error);}}// Transfer notes\nfor(const note of guestNotes){try{await notesAPI.create({title:note.title,content:note.content,folder:note.folder});}catch(error){console.error('Error transferring note:',error);}}// Clear guest data\nlocalStorage.removeItem('guest_notes');localStorage.removeItem('guest_folders');localStorage.removeItem('guest_tags');}catch(error){console.error('Error transferring guest data:',error);}};// Загружаем данные для авторизованных пользователей или гостевые данные\nuseEffect(()=>{if(!authLoading){if(user){loadData();}else{// Загружаем гостевые данные\nconst guestNotes=getGuestNotes();const guestFolders=getGuestFolders();const guestTags=getGuestTags();setNotes(guestNotes);setFolders(guestFolders);setTags(guestTags);setLoading(false);}}// eslint-disable-next-line react-hooks/exhaustive-deps\n},[authLoading,user]);// Автоматически открываем пустой редактор при первой загрузке (даже без авторизации)\nuseEffect(()=>{if(!authLoading&&isInitialLoad&&!showEditor&&!showTemplateBuilder){setShowEditor(true);setSelectedNote(null);setIsInitialLoad(false);}// eslint-disable-next-line react-hooks/exhaustive-deps\n},[authLoading,isInitialLoad,showEditor,showTemplateBuilder]);useEffect(()=>{if(!authLoading&&user){loadNotes();}// eslint-disable-next-line react-hooks/exhaustive-deps\n},[selectedFolder,selectedTags,debouncedSearchQuery,authLoading,user]);const loadData=async()=>{try{var _foldersRes$data,_tagsRes$data;setError(null);console.log('Loading folders and tags...');const[foldersRes,tagsRes]=await Promise.all([foldersAPI.getAll(),tagsAPI.getAll()]);const foldersData=Array.isArray(foldersRes.data)?foldersRes.data:((_foldersRes$data=foldersRes.data)===null||_foldersRes$data===void 0?void 0:_foldersRes$data.results)||[];const tagsData=Array.isArray(tagsRes.data)?tagsRes.data:((_tagsRes$data=tagsRes.data)===null||_tagsRes$data===void 0?void 0:_tagsRes$data.results)||[];console.log('Loaded folders:',foldersData.length);console.log('Loaded tags:',tagsData.length);setFolders(foldersData);setTags(tagsData);}catch(error){var _error$response;console.error('Error loading data:',error);console.error('Error response:',error.response);setFolders([]);setTags([]);if(((_error$response=error.response)===null||_error$response===void 0?void 0:_error$response.status)===401){setError('Сессия истекла. Пожалуйста, войдите снова.');}else{toast.error('Ошибка загрузки папок и тегов');}}};const loadNotes=async()=>{try{setLoading(true);setError(null);const params={};if(selectedFolder)params.folder=selectedFolder;if(selectedTags.length>0)params.tags=selectedTags;if(debouncedSearchQuery)params.search=debouncedSearchQuery;const response=await notesAPI.getAll(params);const notesData=response.data.results||response.data||[];setNotes(Array.isArray(notesData)?notesData:[]);}catch(error){var _error$response2;console.error('Error loading notes:',error);setNotes([]);if(((_error$response2=error.response)===null||_error$response2===void 0?void 0:_error$response2.status)===401){setError('Сессия истекла. Пожалуйста, войдите снова.');}else{setError('Ошибка загрузки заметок. Попробуйте обновить страницу.');}}finally{setLoading(false);}};const handleCreateNote=async function(){let noteData=arguments.length>0&&arguments[0]!==undefined?arguments[0]:null;if(noteData){// Если передан noteData (из шаблона), создаем заметку\nif(noteData.id&&(noteData.name||noteData.template_name)){// Это шаблон из Sidebar - открываем TemplateBuilder\ntry{console.log('Opening template builder for:',noteData);// Устанавливаем шаблон для открытия в TemplateBuilder\nsetSelectedTemplate(noteData);setShowTemplateBuilder(true);setShowEditor(false);}catch(error){console.error('Error opening template builder:',error);toast.error('Ошибка при открытии шаблона');}}else if(noteData.formData||noteData.template){// Это данные из TemplateBuilder\ntry{const newNote=await notesAPI.create({title:noteData.title||'Новая заметка',content:noteData.content||'',template:noteData.template});toast.success('Заметка создана из шаблона');await loadNotes();// Закрываем TemplateBuilder\nsetShowTemplateBuilder(false);setSelectedTemplate(null);// Открываем созданную заметку в редакторе\nif(newNote&&newNote.data){setSelectedNote(newNote.data);setShowEditor(true);}}catch(error){var _error$response3,_error$response3$data;console.error('Error creating note from template:',error);toast.error(((_error$response3=error.response)===null||_error$response3===void 0?void 0:(_error$response3$data=_error$response3.data)===null||_error$response3$data===void 0?void 0:_error$response3$data.error)||'Ошибка при создании заметки из шаблона');}}else{// Это существующая заметка\nsetSelectedNote(noteData);setShowEditor(true);}}else{// Создаем новую заметку\nsetSelectedNote(null);setShowEditor(true);}};const handleEditNote=note=>{setSelectedNote(note);setShowEditor(true);};const handleSaveNote=async function(noteData){let isFormData=arguments.length>1&&arguments[1]!==undefined?arguments[1]:false;// Если пользователь не авторизован, сохраняем в guest mode\nif(!user){const guestNote={title:noteData.title||'Без названия',content:noteData.content||'',folder:noteData.folder||null,tags:noteData.tags||[],id:(selectedNote===null||selectedNote===void 0?void 0:selectedNote.id)||null};if(saveGuestNote(guestNote)){const guestNotes=getGuestNotes();const savedNote=guestNote.id?guestNotes.find(n=>n.id===guestNote.id)||guestNote:guestNotes[guestNotes.length-1];setSelectedNote(savedNote);toast.success('Заметка сохранена (гостевой режим)');return savedNote;}return null;}try{let savedNote;if(selectedNote&&selectedNote.id){if(isFormData){const response=await notesAPI.update(selectedNote.id,noteData,true);savedNote=response.data;}else{const response=await notesAPI.update(selectedNote.id,noteData);savedNote=response.data;}toast.success('Заметка обновлена');setSelectedNote(savedNote);}else{if(isFormData){const response=await notesAPI.create(noteData,true);savedNote=response.data;}else{const response=await notesAPI.create(noteData);savedNote=response.data;}toast.success('Заметка создана');setSelectedNote(savedNote);}await loadNotes();// Не закрываем редактор после сохранения, чтобы можно было экспортировать\nreturn savedNote;}catch(error){var _error$response4;console.error('Error saving note:',error);if(((_error$response4=error.response)===null||_error$response4===void 0?void 0:_error$response4.status)===401){// Сессия истекла, показываем модальное окно\nsetPendingNoteData(noteData);setShowAuthModal(true);}else{toast.error('Ошибка при сохранении заметки');throw error;}}};const handleAuthSuccess=async()=>{// После успешной авторизации переносим гостевые данные\nawait transferGuestData();await loadData();await loadNotes();// После успешной авторизации сохраняем отложенную заметку\nif(pendingNoteData){try{const response=await notesAPI.create(pendingNoteData);toast.success('Заметка создана');await loadNotes();// Открываем созданную заметку в редакторе\nif(response&&response.data){setSelectedNote(response.data);setShowEditor(true);}setPendingNoteData(null);}catch(error){console.error('Error saving note after auth:',error);toast.error('Ошибка при сохранении заметки');setPendingNoteData(null);}}};const handleDeleteNote=noteId=>{setDeleteModal({isOpen:true,noteId});};const confirmDelete=async()=>{if(deleteModal.noteId){try{await notesAPI.delete(deleteModal.noteId);await loadNotes();if((selectedNote===null||selectedNote===void 0?void 0:selectedNote.id)===deleteModal.noteId){setShowEditor(false);setSelectedNote(null);}setDeleteModal({isOpen:false,noteId:null});}catch(error){console.error('Error deleting note:',error);setDeleteModal({isOpen:false,noteId:null});}}};const handlePinNote=async noteId=>{try{await notesAPI.pin(noteId);const note=notes.find(n=>n.id===noteId);toast.success(note!==null&&note!==void 0&&note.is_pinned?'Заметка откреплена':'Заметка закреплена');await loadNotes();}catch(error){console.error('Error pinning note:',error);toast.error('Ошибка при изменении статуса заметки');}};// Клавиатурные сокращения\nuseKeyboardShortcuts({'ctrl+n':e=>{e.preventDefault();if(!showEditor){handleCreateNote();}},'ctrl+k':e=>{e.preventDefault();// Фокус на поиск\nconst searchInput=document.querySelector('.search-input');if(searchInput){searchInput.focus();searchInput.select();}},'escape':()=>{if(showEditor){setShowEditor(false);setSelectedNote(null);}if(deleteModal.isOpen){setDeleteModal({isOpen:false,noteId:null});}}},[showEditor,deleteModal,handleCreateNote]);// Показываем загрузку только если еще загружается аутентификация\nif(authLoading){return/*#__PURE__*/_jsxs(\"div\",{style:{display:'flex',flexDirection:'column',justifyContent:'center',alignItems:'center',height:'100vh',fontSize:'17px',color:'var(--text-secondary)',background:'var(--bg-color)'},children:[/*#__PURE__*/_jsx(\"div\",{style:{width:'40px',height:'40px',border:'3px solid var(--border-color)',borderTopColor:'var(--primary-color)',borderRadius:'50%',animation:'spin 1s linear infinite',marginBottom:'16px'}}),/*#__PURE__*/_jsx(\"style\",{children:\"\\n          @keyframes spin {\\n            to { transform: rotate(360deg); }\\n          }\\n        \"}),\"\\u0417\\u0430\\u0433\\u0440\\u0443\\u0437\\u043A\\u0430...\"]});}return/*#__PURE__*/_jsxs(\"div\",{className:\"notes-app\",children:[/*#__PURE__*/_jsx(Header,{user:user,onLogout:logout,searchQuery:searchQuery,onSearchChange:setSearchQuery,onCreateNote:handleCreateNote,onTemplateSelect:template=>{setSelectedTemplate(template);setShowTemplateBuilder(true);setShowEditor(false);},onSidebarToggle:()=>setIsSidebarOpen(!isSidebarOpen),onSearchToggle:()=>setIsSearchOpen(!isSearchOpen),isSidebarOpen:isSidebarOpen,isSearchOpen:isSearchOpen,onAuthRequired:()=>setShowAuthModal(true)}),/*#__PURE__*/_jsxs(\"div\",{className:\"notes-app-content\",children:[/*#__PURE__*/_jsx(Sidebar,{folders:user?folders:getGuestFolders(),tags:user?tags:getGuestTags(),selectedFolder:selectedFolder,selectedTags:selectedTags,onFolderSelect:setSelectedFolder,onTagSelect:setSelectedTags,onFolderCreate:async folderData=>{if(!user){if(saveGuestFolder(folderData)){const guestFolders=getGuestFolders();setFolders(guestFolders);toast.success('Папка создана (гостевой режим)');}}else{await loadData();}},onTagCreate:async tagData=>{if(!user){if(saveGuestTag(tagData)){const guestTags=getGuestTags();setTags(guestTags);toast.success('Тег создан (гостевой режим)');}}else{await loadData();}},onTemplateSelect:handleCreateNote,loading:loading&&folders.length===0,user:user,onAuthRequired:()=>setShowAuthModal(true),isOpen:isSidebarOpen,onClose:()=>setIsSidebarOpen(false)}),/*#__PURE__*/_jsxs(\"div\",{className:\"notes-main\",children:[error&&/*#__PURE__*/_jsxs(\"div\",{className:\"error-banner\",children:[/*#__PURE__*/_jsx(\"span\",{children:error}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>{setError(null);loadNotes();},children:\"\\u041E\\u0431\\u043D\\u043E\\u0432\\u0438\\u0442\\u044C\"})]}),showTemplateBuilder&&selectedTemplate?/*#__PURE__*/_jsx(TemplateBuilder,{template:selectedTemplate,onSave:handleCreateNote,onCancel:()=>{setShowTemplateBuilder(false);setSelectedTemplate(null);}}):showEditor?/*#__PURE__*/_jsx(NoteEditor,{note:selectedNote,folders:user?folders:[],tags:user?tags:[],onSave:handleSaveNote,onCancel:()=>{setShowEditor(false);setSelectedNote(null);}}):/*#__PURE__*/_jsx(_Fragment,{children:/*#__PURE__*/_jsx(NotesGrid,{notes:user?notes:getGuestNotes(),loading:loading,onEdit:handleEditNote,onDelete:handleDeleteNote,onPin:handlePinNote})})]})]}),/*#__PURE__*/_jsx(DeleteModal,{isOpen:deleteModal.isOpen,onClose:()=>setDeleteModal({isOpen:false,noteId:null}),onConfirm:confirmDelete,title:\"\\u0423\\u0434\\u0430\\u043B\\u0435\\u043D\\u0438\\u0435 \\u0437\\u0430\\u043C\\u0435\\u0442\\u043A\\u0438\",message:\"\\u0412\\u044B \\u0443\\u0432\\u0435\\u0440\\u0435\\u043D\\u044B, \\u0447\\u0442\\u043E \\u0445\\u043E\\u0442\\u0438\\u0442\\u0435 \\u0443\\u0434\\u0430\\u043B\\u0438\\u0442\\u044C \\u044D\\u0442\\u0443 \\u0437\\u0430\\u043C\\u0435\\u0442\\u043A\\u0443? \\u042D\\u0442\\u043E \\u0434\\u0435\\u0439\\u0441\\u0442\\u0432\\u0438\\u0435 \\u043D\\u0435\\u043B\\u044C\\u0437\\u044F \\u043E\\u0442\\u043C\\u0435\\u043D\\u0438\\u0442\\u044C.\"}),/*#__PURE__*/_jsx(AuthModal,{isOpen:showAuthModal,onClose:()=>{setShowAuthModal(false);setPendingNoteData(null);},onSuccess:handleAuthSuccess})]});};export default NotesApp;","map":{"version":3,"names":["React","useState","useEffect","toast","useAuth","useDebounce","useKeyboardShortcuts","Header","Sidebar","NotesGrid","NoteEditor","TemplateBuilder","DeleteModal","AuthModal","notesAPI","foldersAPI","tagsAPI","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","NotesApp","user","logout","loading","authLoading","notes","setNotes","folders","setFolders","tags","setTags","selectedNote","setSelectedNote","selectedFolder","setSelectedFolder","selectedTags","setSelectedTags","searchQuery","setSearchQuery","showEditor","setShowEditor","setLoading","error","setError","deleteModal","setDeleteModal","isOpen","noteId","selectedTemplate","setSelectedTemplate","showTemplateBuilder","setShowTemplateBuilder","isInitialLoad","setIsInitialLoad","showAuthModal","setShowAuthModal","pendingNoteData","setPendingNoteData","isSidebarOpen","setIsSidebarOpen","isSearchOpen","setIsSearchOpen","debouncedSearchQuery","getGuestNotes","stored","localStorage","getItem","JSON","parse","_unused","getGuestFolders","_unused2","getGuestTags","_unused3","saveGuestNote","note","guestNotes","length","id","updatedNotes","map","n","_objectSpread","concat","Date","now","setItem","stringify","saveGuestFolder","folder","guestFolders","updatedFolders","f","saveGuestTag","tag","guestTags","updatedTags","t","transferGuestData","create","name","color","console","title","content","removeItem","loadData","loadNotes","_foldersRes$data","_tagsRes$data","log","foldersRes","tagsRes","Promise","all","getAll","foldersData","Array","isArray","data","results","tagsData","_error$response","response","status","params","search","notesData","_error$response2","handleCreateNote","noteData","arguments","undefined","template_name","formData","template","newNote","success","_error$response3","_error$response3$data","handleEditNote","handleSaveNote","isFormData","guestNote","savedNote","find","update","_error$response4","handleAuthSuccess","handleDeleteNote","confirmDelete","delete","handlePinNote","pin","is_pinned","e","preventDefault","searchInput","document","querySelector","focus","select","escape","style","display","flexDirection","justifyContent","alignItems","height","fontSize","background","children","width","border","borderTopColor","borderRadius","animation","marginBottom","className","onLogout","onSearchChange","onCreateNote","onTemplateSelect","onSidebarToggle","onSearchToggle","onAuthRequired","onFolderSelect","onTagSelect","onFolderCreate","folderData","onTagCreate","tagData","onClose","onClick","onSave","onCancel","onEdit","onDelete","onPin","onConfirm","message","onSuccess"],"sources":["/Users/mikhail/Downloads/blo-pro/frontend/src/components/NotesApp.js"],"sourcesContent":["import React, { useState, useEffect } from 'react';\nimport toast from 'react-hot-toast';\nimport { useAuth } from '../contexts/AuthContext';\nimport { useDebounce } from '../hooks/useDebounce';\nimport { useKeyboardShortcuts } from '../hooks/useKeyboardShortcuts';\nimport Header from './Header/Header';\nimport Sidebar from './Sidebar/Sidebar';\nimport NotesGrid from './Notes/NotesGrid';\nimport NoteEditor from './Notes/NoteEditor';\nimport TemplateBuilder from './Templates/TemplateBuilder';\nimport DeleteModal from './Modal/DeleteModal';\nimport AuthModal from './Auth/AuthModal';\nimport { notesAPI, foldersAPI, tagsAPI } from '../api/api';\nimport './NotesApp.css';\n\nconst NotesApp = () => {\n  const { user, logout, loading: authLoading } = useAuth();\n  const [notes, setNotes] = useState([]);\n  const [folders, setFolders] = useState([]);\n  const [tags, setTags] = useState([]);\n  const [selectedNote, setSelectedNote] = useState(null);\n  const [selectedFolder, setSelectedFolder] = useState(null);\n  const [selectedTags, setSelectedTags] = useState([]);\n  const [searchQuery, setSearchQuery] = useState('');\n  const [showEditor, setShowEditor] = useState(false);\n  const [loading, setLoading] = useState(true);\n  const [error, setError] = useState(null);\n  const [deleteModal, setDeleteModal] = useState({ isOpen: false, noteId: null });\n  const [selectedTemplate, setSelectedTemplate] = useState(null);\n  const [showTemplateBuilder, setShowTemplateBuilder] = useState(false);\n  const [isInitialLoad, setIsInitialLoad] = useState(true);\n  const [showAuthModal, setShowAuthModal] = useState(false);\n  const [pendingNoteData, setPendingNoteData] = useState(null);\n  const [isSidebarOpen, setIsSidebarOpen] = useState(false);\n  const [isSearchOpen, setIsSearchOpen] = useState(false);\n\n  // Debounce поискового запроса\n  const debouncedSearchQuery = useDebounce(searchQuery, 300);\n\n  // Guest mode helpers\n  const getGuestNotes = () => {\n    try {\n      const stored = localStorage.getItem('guest_notes');\n      return stored ? JSON.parse(stored) : [];\n    } catch {\n      return [];\n    }\n  };\n\n  const getGuestFolders = () => {\n    try {\n      const stored = localStorage.getItem('guest_folders');\n      return stored ? JSON.parse(stored) : [];\n    } catch {\n      return [];\n    }\n  };\n\n  const getGuestTags = () => {\n    try {\n      const stored = localStorage.getItem('guest_tags');\n      return stored ? JSON.parse(stored) : [];\n    } catch {\n      return [];\n    }\n  };\n\n  const saveGuestNote = (note) => {\n    const guestNotes = getGuestNotes();\n    if (guestNotes.length >= 1 && !note.id) {\n      toast.error('Для создания больше заметок необходимо зарегистрироваться');\n      setShowAuthModal(true);\n      return false;\n    }\n    const updatedNotes = note.id \n      ? guestNotes.map(n => n.id === note.id ? { ...note, id: note.id } : n)\n      : [...guestNotes, { ...note, id: `guest_${Date.now()}` }];\n    localStorage.setItem('guest_notes', JSON.stringify(updatedNotes));\n    return true;\n  };\n\n  const saveGuestFolder = (folder) => {\n    const guestFolders = getGuestFolders();\n    if (guestFolders.length >= 1 && !folder.id) {\n      toast.error('Для создания больше папок необходимо зарегистрироваться');\n      setShowAuthModal(true);\n      return false;\n    }\n    const updatedFolders = folder.id\n      ? guestFolders.map(f => f.id === folder.id ? folder : f)\n      : [...guestFolders, { ...folder, id: `guest_${Date.now()}` }];\n    localStorage.setItem('guest_folders', JSON.stringify(updatedFolders));\n    return true;\n  };\n\n  const saveGuestTag = (tag) => {\n    const guestTags = getGuestTags();\n    if (guestTags.length >= 1 && !tag.id) {\n      toast.error('Для создания больше тегов необходимо зарегистрироваться');\n      setShowAuthModal(true);\n      return false;\n    }\n    const updatedTags = tag.id\n      ? guestTags.map(t => t.id === tag.id ? tag : t)\n      : [...guestTags, { ...tag, id: `guest_${Date.now()}` }];\n    localStorage.setItem('guest_tags', JSON.stringify(updatedTags));\n    return true;\n  };\n\n  const transferGuestData = async () => {\n    const guestNotes = getGuestNotes();\n    const guestFolders = getGuestFolders();\n    const guestTags = getGuestTags();\n    \n    try {\n      // Transfer folders\n      for (const folder of guestFolders) {\n        try {\n          await foldersAPI.create({ name: folder.name, color: folder.color });\n        } catch (error) {\n          console.error('Error transferring folder:', error);\n        }\n      }\n      \n      // Transfer tags\n      for (const tag of guestTags) {\n        try {\n          await tagsAPI.create({ name: tag.name, color: tag.color });\n        } catch (error) {\n          console.error('Error transferring tag:', error);\n        }\n      }\n      \n      // Transfer notes\n      for (const note of guestNotes) {\n        try {\n          await notesAPI.create({\n            title: note.title,\n            content: note.content,\n            folder: note.folder\n          });\n        } catch (error) {\n          console.error('Error transferring note:', error);\n        }\n      }\n      \n      // Clear guest data\n      localStorage.removeItem('guest_notes');\n      localStorage.removeItem('guest_folders');\n      localStorage.removeItem('guest_tags');\n    } catch (error) {\n      console.error('Error transferring guest data:', error);\n    }\n  };\n\n  // Загружаем данные для авторизованных пользователей или гостевые данные\n  useEffect(() => {\n    if (!authLoading) {\n      if (user) {\n        loadData();\n      } else {\n        // Загружаем гостевые данные\n        const guestNotes = getGuestNotes();\n        const guestFolders = getGuestFolders();\n        const guestTags = getGuestTags();\n        setNotes(guestNotes);\n        setFolders(guestFolders);\n        setTags(guestTags);\n        setLoading(false);\n      }\n    }\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [authLoading, user]);\n\n  // Автоматически открываем пустой редактор при первой загрузке (даже без авторизации)\n  useEffect(() => {\n    if (!authLoading && isInitialLoad && !showEditor && !showTemplateBuilder) {\n      setShowEditor(true);\n      setSelectedNote(null);\n      setIsInitialLoad(false);\n    }\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [authLoading, isInitialLoad, showEditor, showTemplateBuilder]);\n\n  useEffect(() => {\n    if (!authLoading && user) {\n      loadNotes();\n    }\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [selectedFolder, selectedTags, debouncedSearchQuery, authLoading, user]);\n\n  const loadData = async () => {\n    try {\n      setError(null);\n      console.log('Loading folders and tags...');\n      const [foldersRes, tagsRes] = await Promise.all([\n        foldersAPI.getAll(),\n        tagsAPI.getAll(),\n      ]);\n      \n      const foldersData = Array.isArray(foldersRes.data) ? foldersRes.data : \n                         (foldersRes.data?.results || []);\n      const tagsData = Array.isArray(tagsRes.data) ? tagsRes.data : \n                      (tagsRes.data?.results || []);\n      \n      console.log('Loaded folders:', foldersData.length);\n      console.log('Loaded tags:', tagsData.length);\n      \n      setFolders(foldersData);\n      setTags(tagsData);\n    } catch (error) {\n      console.error('Error loading data:', error);\n      console.error('Error response:', error.response);\n      setFolders([]);\n      setTags([]);\n      if (error.response?.status === 401) {\n        setError('Сессия истекла. Пожалуйста, войдите снова.');\n      } else {\n        toast.error('Ошибка загрузки папок и тегов');\n      }\n    }\n  };\n\n  const loadNotes = async () => {\n    try {\n      setLoading(true);\n      setError(null);\n      const params = {};\n      if (selectedFolder) params.folder = selectedFolder;\n      if (selectedTags.length > 0) params.tags = selectedTags;\n      if (debouncedSearchQuery) params.search = debouncedSearchQuery;\n      \n      const response = await notesAPI.getAll(params);\n      const notesData = response.data.results || response.data || [];\n      setNotes(Array.isArray(notesData) ? notesData : []);\n    } catch (error) {\n      console.error('Error loading notes:', error);\n      setNotes([]);\n      if (error.response?.status === 401) {\n        setError('Сессия истекла. Пожалуйста, войдите снова.');\n      } else {\n        setError('Ошибка загрузки заметок. Попробуйте обновить страницу.');\n      }\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const handleCreateNote = async (noteData = null) => {\n    if (noteData) {\n      // Если передан noteData (из шаблона), создаем заметку\n      if (noteData.id && (noteData.name || noteData.template_name)) {\n        // Это шаблон из Sidebar - открываем TemplateBuilder\n        try {\n          console.log('Opening template builder for:', noteData);\n          // Устанавливаем шаблон для открытия в TemplateBuilder\n          setSelectedTemplate(noteData);\n          setShowTemplateBuilder(true);\n          setShowEditor(false);\n        } catch (error) {\n          console.error('Error opening template builder:', error);\n          toast.error('Ошибка при открытии шаблона');\n        }\n      } else if (noteData.formData || noteData.template) {\n        // Это данные из TemplateBuilder\n        try {\n          const newNote = await notesAPI.create({\n            title: noteData.title || 'Новая заметка',\n            content: noteData.content || '',\n            template: noteData.template\n          });\n          toast.success('Заметка создана из шаблона');\n          await loadNotes();\n          // Закрываем TemplateBuilder\n          setShowTemplateBuilder(false);\n          setSelectedTemplate(null);\n          // Открываем созданную заметку в редакторе\n          if (newNote && newNote.data) {\n            setSelectedNote(newNote.data);\n            setShowEditor(true);\n          }\n        } catch (error) {\n          console.error('Error creating note from template:', error);\n          toast.error(error.response?.data?.error || 'Ошибка при создании заметки из шаблона');\n        }\n      } else {\n        // Это существующая заметка\n        setSelectedNote(noteData);\n        setShowEditor(true);\n      }\n    } else {\n      // Создаем новую заметку\n      setSelectedNote(null);\n      setShowEditor(true);\n    }\n  };\n\n  const handleEditNote = (note) => {\n    setSelectedNote(note);\n    setShowEditor(true);\n  };\n\n  const handleSaveNote = async (noteData, isFormData = false) => {\n    // Если пользователь не авторизован, сохраняем в guest mode\n    if (!user) {\n      const guestNote = {\n        title: noteData.title || 'Без названия',\n        content: noteData.content || '',\n        folder: noteData.folder || null,\n        tags: noteData.tags || [],\n        id: selectedNote?.id || null\n      };\n      if (saveGuestNote(guestNote)) {\n        const guestNotes = getGuestNotes();\n        const savedNote = guestNote.id \n          ? guestNotes.find(n => n.id === guestNote.id) || guestNote\n          : guestNotes[guestNotes.length - 1];\n        setSelectedNote(savedNote);\n        toast.success('Заметка сохранена (гостевой режим)');\n        return savedNote;\n      }\n      return null;\n    }\n\n    try {\n      let savedNote;\n      if (selectedNote && selectedNote.id) {\n        if (isFormData) {\n          const response = await notesAPI.update(selectedNote.id, noteData, true);\n          savedNote = response.data;\n        } else {\n          const response = await notesAPI.update(selectedNote.id, noteData);\n          savedNote = response.data;\n        }\n        toast.success('Заметка обновлена');\n        setSelectedNote(savedNote);\n      } else {\n        if (isFormData) {\n          const response = await notesAPI.create(noteData, true);\n          savedNote = response.data;\n        } else {\n          const response = await notesAPI.create(noteData);\n          savedNote = response.data;\n        }\n        toast.success('Заметка создана');\n        setSelectedNote(savedNote);\n      }\n      await loadNotes();\n      // Не закрываем редактор после сохранения, чтобы можно было экспортировать\n      return savedNote;\n    } catch (error) {\n      console.error('Error saving note:', error);\n      if (error.response?.status === 401) {\n        // Сессия истекла, показываем модальное окно\n        setPendingNoteData(noteData);\n        setShowAuthModal(true);\n      } else {\n        toast.error('Ошибка при сохранении заметки');\n        throw error;\n      }\n    }\n  };\n\n  const handleAuthSuccess = async () => {\n    // После успешной авторизации переносим гостевые данные\n    await transferGuestData();\n    await loadData();\n    await loadNotes();\n    \n    // После успешной авторизации сохраняем отложенную заметку\n    if (pendingNoteData) {\n      try {\n        const response = await notesAPI.create(pendingNoteData);\n        toast.success('Заметка создана');\n        await loadNotes();\n        // Открываем созданную заметку в редакторе\n        if (response && response.data) {\n          setSelectedNote(response.data);\n          setShowEditor(true);\n        }\n        setPendingNoteData(null);\n      } catch (error) {\n        console.error('Error saving note after auth:', error);\n        toast.error('Ошибка при сохранении заметки');\n        setPendingNoteData(null);\n      }\n    }\n  };\n\n  const handleDeleteNote = (noteId) => {\n    setDeleteModal({ isOpen: true, noteId });\n  };\n\n  const confirmDelete = async () => {\n    if (deleteModal.noteId) {\n      try {\n        await notesAPI.delete(deleteModal.noteId);\n        await loadNotes();\n        if (selectedNote?.id === deleteModal.noteId) {\n          setShowEditor(false);\n          setSelectedNote(null);\n        }\n        setDeleteModal({ isOpen: false, noteId: null });\n      } catch (error) {\n        console.error('Error deleting note:', error);\n        setDeleteModal({ isOpen: false, noteId: null });\n      }\n    }\n  };\n\n  const handlePinNote = async (noteId) => {\n    try {\n      await notesAPI.pin(noteId);\n      const note = notes.find(n => n.id === noteId);\n      toast.success(note?.is_pinned ? 'Заметка откреплена' : 'Заметка закреплена');\n      await loadNotes();\n    } catch (error) {\n      console.error('Error pinning note:', error);\n      toast.error('Ошибка при изменении статуса заметки');\n    }\n  };\n\n  // Клавиатурные сокращения\n  useKeyboardShortcuts({\n    'ctrl+n': (e) => {\n      e.preventDefault();\n      if (!showEditor) {\n        handleCreateNote();\n      }\n    },\n    'ctrl+k': (e) => {\n      e.preventDefault();\n      // Фокус на поиск\n      const searchInput = document.querySelector('.search-input');\n      if (searchInput) {\n        searchInput.focus();\n        searchInput.select();\n      }\n    },\n    'escape': () => {\n      if (showEditor) {\n        setShowEditor(false);\n        setSelectedNote(null);\n      }\n      if (deleteModal.isOpen) {\n        setDeleteModal({ isOpen: false, noteId: null });\n      }\n    },\n  }, [showEditor, deleteModal, handleCreateNote]);\n\n  // Показываем загрузку только если еще загружается аутентификация\n  if (authLoading) {\n    return (\n      <div style={{ \n        display: 'flex', \n        flexDirection: 'column',\n        justifyContent: 'center', \n        alignItems: 'center', \n        height: '100vh',\n        fontSize: '17px',\n        color: 'var(--text-secondary)',\n        background: 'var(--bg-color)'\n      }}>\n        <div style={{\n          width: '40px',\n          height: '40px',\n          border: '3px solid var(--border-color)',\n          borderTopColor: 'var(--primary-color)',\n          borderRadius: '50%',\n          animation: 'spin 1s linear infinite',\n          marginBottom: '16px'\n        }}></div>\n        <style>{`\n          @keyframes spin {\n            to { transform: rotate(360deg); }\n          }\n        `}</style>\n        Загрузка...\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"notes-app\">\n      <Header\n        user={user}\n        onLogout={logout}\n        searchQuery={searchQuery}\n        onSearchChange={setSearchQuery}\n        onCreateNote={handleCreateNote}\n        onTemplateSelect={(template) => {\n          setSelectedTemplate(template);\n          setShowTemplateBuilder(true);\n          setShowEditor(false);\n        }}\n        onSidebarToggle={() => setIsSidebarOpen(!isSidebarOpen)}\n        onSearchToggle={() => setIsSearchOpen(!isSearchOpen)}\n        isSidebarOpen={isSidebarOpen}\n        isSearchOpen={isSearchOpen}\n        onAuthRequired={() => setShowAuthModal(true)}\n      />\n      <div className=\"notes-app-content\">\n        <Sidebar\n          folders={user ? folders : getGuestFolders()}\n          tags={user ? tags : getGuestTags()}\n          selectedFolder={selectedFolder}\n          selectedTags={selectedTags}\n          onFolderSelect={setSelectedFolder}\n          onTagSelect={setSelectedTags}\n          onFolderCreate={async (folderData) => {\n            if (!user) {\n              if (saveGuestFolder(folderData)) {\n                const guestFolders = getGuestFolders();\n                setFolders(guestFolders);\n                toast.success('Папка создана (гостевой режим)');\n              }\n            } else {\n              await loadData();\n            }\n          }}\n          onTagCreate={async (tagData) => {\n            if (!user) {\n              if (saveGuestTag(tagData)) {\n                const guestTags = getGuestTags();\n                setTags(guestTags);\n                toast.success('Тег создан (гостевой режим)');\n              }\n            } else {\n              await loadData();\n            }\n          }}\n          onTemplateSelect={handleCreateNote}\n          loading={loading && folders.length === 0}\n          user={user}\n          onAuthRequired={() => setShowAuthModal(true)}\n          isOpen={isSidebarOpen}\n          onClose={() => setIsSidebarOpen(false)}\n        />\n        <div className=\"notes-main\">\n          {error && (\n            <div className=\"error-banner\">\n              <span>{error}</span>\n              <button onClick={() => { setError(null); loadNotes(); }}>Обновить</button>\n            </div>\n          )}\n          {showTemplateBuilder && selectedTemplate ? (\n            <TemplateBuilder\n              template={selectedTemplate}\n              onSave={handleCreateNote}\n              onCancel={() => {\n                setShowTemplateBuilder(false);\n                setSelectedTemplate(null);\n              }}\n            />\n          ) : showEditor ? (\n            <NoteEditor\n              note={selectedNote}\n              folders={user ? folders : []}\n              tags={user ? tags : []}\n              onSave={handleSaveNote}\n              onCancel={() => {\n                setShowEditor(false);\n                setSelectedNote(null);\n              }}\n            />\n          ) : (\n            <>\n              <NotesGrid\n                notes={user ? notes : getGuestNotes()}\n                loading={loading}\n                onEdit={handleEditNote}\n                onDelete={handleDeleteNote}\n                onPin={handlePinNote}\n              />\n            </>\n          )}\n        </div>\n      </div>\n      <DeleteModal\n        isOpen={deleteModal.isOpen}\n        onClose={() => setDeleteModal({ isOpen: false, noteId: null })}\n        onConfirm={confirmDelete}\n        title=\"Удаление заметки\"\n        message=\"Вы уверены, что хотите удалить эту заметку? Это действие нельзя отменить.\"\n      />\n      <AuthModal\n        isOpen={showAuthModal}\n        onClose={() => {\n          setShowAuthModal(false);\n          setPendingNoteData(null);\n        }}\n        onSuccess={handleAuthSuccess}\n      />\n    </div>\n  );\n};\n\nexport default NotesApp;\n\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}