{"ast":null,"code":"import React,{useState,useEffect}from'react';import{firefliesAPI}from'../../api/api';import{useAuth}from'../../contexts/AuthContext';import FireflyAnimation from'./FireflyAnimation';import StreakDisplay from'./StreakDisplay';import Layout from'../Layout/Layout';import'./FirefliesSystem.css';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const FirefliesSystem=()=>{const{user}=useAuth();const[fireflies,setFireflies]=useState([]);const[loading,setLoading]=useState(true);const[streak,setStreak]=useState({streak_days:0,longest_streak:0});useEffect(()=>{if(user){loadFireflies();loadStreak();checkStreak();}},[user]);const loadFireflies=async()=>{try{const response=await firefliesAPI.getFireflies();setFireflies(response.data);}catch(error){console.error('Error loading fireflies:',error);}finally{setLoading(false);}};const loadStreak=async()=>{if(!user)return;try{const response=await firefliesAPI.getUserStreak(user.id);setStreak(response.data);}catch(error){console.error('Error loading streak:',error);}};const checkStreak=async()=>{try{await firefliesAPI.checkStreak();loadStreak();}catch(error){console.error('Error checking streak:',error);}};return/*#__PURE__*/_jsx(Layout,{children:/*#__PURE__*/_jsxs(\"div\",{className:\"fireflies-system\",children:[/*#__PURE__*/_jsx(StreakDisplay,{streak:streak}),/*#__PURE__*/_jsxs(\"div\",{className:\"fireflies-received\",children:[/*#__PURE__*/_jsx(\"h2\",{className:\"fireflies-title\",children:\"\\u041E\\u0433\\u043E\\u043D\\u044C\\u043A\\u0438 \\u043E\\u0442 \\u0434\\u0440\\u0443\\u0437\\u0435\\u0439\"}),loading?/*#__PURE__*/_jsx(\"div\",{className:\"fireflies-loading\",children:\"\\u0417\\u0430\\u0433\\u0440\\u0443\\u0437\\u043A\\u0430...\"}):fireflies.length===0?/*#__PURE__*/_jsx(\"div\",{className:\"fireflies-empty\",children:/*#__PURE__*/_jsx(\"p\",{children:\"\\u041F\\u043E\\u043A\\u0430 \\u043D\\u0435\\u0442 \\u043E\\u0433\\u043E\\u043D\\u044C\\u043A\\u043E\\u0432\"})}):/*#__PURE__*/_jsx(\"div\",{className:\"fireflies-list\",children:fireflies.map(firefly=>/*#__PURE__*/_jsxs(\"div\",{className:\"firefly-item\",children:[/*#__PURE__*/_jsx(FireflyAnimation,{}),/*#__PURE__*/_jsxs(\"div\",{className:\"firefly-content\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"firefly-sender\",children:firefly.sender.username}),firefly.message&&/*#__PURE__*/_jsx(\"div\",{className:\"firefly-message\",children:firefly.message}),firefly.note&&/*#__PURE__*/_jsxs(\"div\",{className:\"firefly-note\",children:[/*#__PURE__*/_jsxs(\"svg\",{width:\"16\",height:\"16\",viewBox:\"0 0 24 24\",fill:\"none\",xmlns:\"http://www.w3.org/2000/svg\",style:{display:'inline-block',marginRight:'6px',verticalAlign:'middle'},children:[/*#__PURE__*/_jsx(\"path\",{d:\"M14 2H6C5.46957 2 4.96086 2.21071 4.58579 2.58579C4.21071 2.96086 4 3.46957 4 4V20C4 20.5304 4.21071 21.0391 4.58579 21.4142C4.96086 21.7893 5.46957 22 6 22H18C18.5304 22 19.0391 21.7893 19.4142 21.4142C19.7893 21.0391 20 20.5304 20 20V8L14 2Z\",stroke:\"currentColor\",strokeWidth:\"2\",strokeLinecap:\"round\",strokeLinejoin:\"round\"}),/*#__PURE__*/_jsx(\"path\",{d:\"M14 2V8H20\",stroke:\"currentColor\",strokeWidth:\"2\",strokeLinecap:\"round\",strokeLinejoin:\"round\"})]}),firefly.note.title]}),/*#__PURE__*/_jsx(\"div\",{className:\"firefly-time\",children:new Date(firefly.created_at).toLocaleString('ru-RU')})]})]},firefly.id))})]})]})});};export default FirefliesSystem;","map":{"version":3,"names":["React","useState","useEffect","firefliesAPI","useAuth","FireflyAnimation","StreakDisplay","Layout","jsx","_jsx","jsxs","_jsxs","FirefliesSystem","user","fireflies","setFireflies","loading","setLoading","streak","setStreak","streak_days","longest_streak","loadFireflies","loadStreak","checkStreak","response","getFireflies","data","error","console","getUserStreak","id","children","className","length","map","firefly","sender","username","message","note","width","height","viewBox","fill","xmlns","style","display","marginRight","verticalAlign","d","stroke","strokeWidth","strokeLinecap","strokeLinejoin","title","Date","created_at","toLocaleString"],"sources":["/Users/mikhail/Downloads/blo-pro/frontend/src/components/Fireflies/FirefliesSystem.js"],"sourcesContent":["import React, { useState, useEffect } from 'react';\nimport { firefliesAPI } from '../../api/api';\nimport { useAuth } from '../../contexts/AuthContext';\nimport FireflyAnimation from './FireflyAnimation';\nimport StreakDisplay from './StreakDisplay';\nimport Layout from '../Layout/Layout';\nimport './FirefliesSystem.css';\n\nconst FirefliesSystem = () => {\n  const { user } = useAuth();\n  const [fireflies, setFireflies] = useState([]);\n  const [loading, setLoading] = useState(true);\n  const [streak, setStreak] = useState({ streak_days: 0, longest_streak: 0 });\n\n  useEffect(() => {\n    if (user) {\n      loadFireflies();\n      loadStreak();\n      checkStreak();\n    }\n  }, [user]);\n\n  const loadFireflies = async () => {\n    try {\n      const response = await firefliesAPI.getFireflies();\n      setFireflies(response.data);\n    } catch (error) {\n      console.error('Error loading fireflies:', error);\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const loadStreak = async () => {\n    if (!user) return;\n    try {\n      const response = await firefliesAPI.getUserStreak(user.id);\n      setStreak(response.data);\n    } catch (error) {\n      console.error('Error loading streak:', error);\n    }\n  };\n\n  const checkStreak = async () => {\n    try {\n      await firefliesAPI.checkStreak();\n      loadStreak();\n    } catch (error) {\n      console.error('Error checking streak:', error);\n    }\n  };\n\n  return (\n    <Layout>\n      <div className=\"fireflies-system\">\n      <StreakDisplay streak={streak} />\n      \n      <div className=\"fireflies-received\">\n        <h2 className=\"fireflies-title\">Огоньки от друзей</h2>\n        {loading ? (\n          <div className=\"fireflies-loading\">Загрузка...</div>\n        ) : fireflies.length === 0 ? (\n          <div className=\"fireflies-empty\">\n            <p>Пока нет огоньков</p>\n          </div>\n        ) : (\n          <div className=\"fireflies-list\">\n            {fireflies.map(firefly => (\n              <div key={firefly.id} className=\"firefly-item\">\n                <FireflyAnimation />\n                <div className=\"firefly-content\">\n                  <div className=\"firefly-sender\">\n                    {firefly.sender.username}\n                  </div>\n                  {firefly.message && (\n                    <div className=\"firefly-message\">{firefly.message}</div>\n                  )}\n                  {firefly.note && (\n                    <div className=\"firefly-note\">\n                      <svg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\" style={{ display: 'inline-block', marginRight: '6px', verticalAlign: 'middle' }}>\n                        <path d=\"M14 2H6C5.46957 2 4.96086 2.21071 4.58579 2.58579C4.21071 2.96086 4 3.46957 4 4V20C4 20.5304 4.21071 21.0391 4.58579 21.4142C4.96086 21.7893 5.46957 22 6 22H18C18.5304 22 19.0391 21.7893 19.4142 21.4142C19.7893 21.0391 20 20.5304 20 20V8L14 2Z\" stroke=\"currentColor\" strokeWidth=\"2\" strokeLinecap=\"round\" strokeLinejoin=\"round\"/>\n                        <path d=\"M14 2V8H20\" stroke=\"currentColor\" strokeWidth=\"2\" strokeLinecap=\"round\" strokeLinejoin=\"round\"/>\n                      </svg>\n                      {firefly.note.title}\n                    </div>\n                  )}\n                  <div className=\"firefly-time\">\n                    {new Date(firefly.created_at).toLocaleString('ru-RU')}\n                  </div>\n                </div>\n              </div>\n            ))}\n          </div>\n        )}\n      </div>\n      </div>\n    </Layout>\n  );\n};\n\nexport default FirefliesSystem;\n"],"mappings":"AAAA,MAAO,CAAAA,KAAK,EAAIC,QAAQ,CAAEC,SAAS,KAAQ,OAAO,CAClD,OAASC,YAAY,KAAQ,eAAe,CAC5C,OAASC,OAAO,KAAQ,4BAA4B,CACpD,MAAO,CAAAC,gBAAgB,KAAM,oBAAoB,CACjD,MAAO,CAAAC,aAAa,KAAM,iBAAiB,CAC3C,MAAO,CAAAC,MAAM,KAAM,kBAAkB,CACrC,MAAO,uBAAuB,CAAC,OAAAC,GAAA,IAAAC,IAAA,CAAAC,IAAA,IAAAC,KAAA,yBAE/B,KAAM,CAAAC,eAAe,CAAGA,CAAA,GAAM,CAC5B,KAAM,CAAEC,IAAK,CAAC,CAAGT,OAAO,CAAC,CAAC,CAC1B,KAAM,CAACU,SAAS,CAAEC,YAAY,CAAC,CAAGd,QAAQ,CAAC,EAAE,CAAC,CAC9C,KAAM,CAACe,OAAO,CAAEC,UAAU,CAAC,CAAGhB,QAAQ,CAAC,IAAI,CAAC,CAC5C,KAAM,CAACiB,MAAM,CAAEC,SAAS,CAAC,CAAGlB,QAAQ,CAAC,CAAEmB,WAAW,CAAE,CAAC,CAAEC,cAAc,CAAE,CAAE,CAAC,CAAC,CAE3EnB,SAAS,CAAC,IAAM,CACd,GAAIW,IAAI,CAAE,CACRS,aAAa,CAAC,CAAC,CACfC,UAAU,CAAC,CAAC,CACZC,WAAW,CAAC,CAAC,CACf,CACF,CAAC,CAAE,CAACX,IAAI,CAAC,CAAC,CAEV,KAAM,CAAAS,aAAa,CAAG,KAAAA,CAAA,GAAY,CAChC,GAAI,CACF,KAAM,CAAAG,QAAQ,CAAG,KAAM,CAAAtB,YAAY,CAACuB,YAAY,CAAC,CAAC,CAClDX,YAAY,CAACU,QAAQ,CAACE,IAAI,CAAC,CAC7B,CAAE,MAAOC,KAAK,CAAE,CACdC,OAAO,CAACD,KAAK,CAAC,0BAA0B,CAAEA,KAAK,CAAC,CAClD,CAAC,OAAS,CACRX,UAAU,CAAC,KAAK,CAAC,CACnB,CACF,CAAC,CAED,KAAM,CAAAM,UAAU,CAAG,KAAAA,CAAA,GAAY,CAC7B,GAAI,CAACV,IAAI,CAAE,OACX,GAAI,CACF,KAAM,CAAAY,QAAQ,CAAG,KAAM,CAAAtB,YAAY,CAAC2B,aAAa,CAACjB,IAAI,CAACkB,EAAE,CAAC,CAC1DZ,SAAS,CAACM,QAAQ,CAACE,IAAI,CAAC,CAC1B,CAAE,MAAOC,KAAK,CAAE,CACdC,OAAO,CAACD,KAAK,CAAC,uBAAuB,CAAEA,KAAK,CAAC,CAC/C,CACF,CAAC,CAED,KAAM,CAAAJ,WAAW,CAAG,KAAAA,CAAA,GAAY,CAC9B,GAAI,CACF,KAAM,CAAArB,YAAY,CAACqB,WAAW,CAAC,CAAC,CAChCD,UAAU,CAAC,CAAC,CACd,CAAE,MAAOK,KAAK,CAAE,CACdC,OAAO,CAACD,KAAK,CAAC,wBAAwB,CAAEA,KAAK,CAAC,CAChD,CACF,CAAC,CAED,mBACEnB,IAAA,CAACF,MAAM,EAAAyB,QAAA,cACLrB,KAAA,QAAKsB,SAAS,CAAC,kBAAkB,CAAAD,QAAA,eACjCvB,IAAA,CAACH,aAAa,EAACY,MAAM,CAAEA,MAAO,CAAE,CAAC,cAEjCP,KAAA,QAAKsB,SAAS,CAAC,oBAAoB,CAAAD,QAAA,eACjCvB,IAAA,OAAIwB,SAAS,CAAC,iBAAiB,CAAAD,QAAA,CAAC,8FAAiB,CAAI,CAAC,CACrDhB,OAAO,cACNP,IAAA,QAAKwB,SAAS,CAAC,mBAAmB,CAAAD,QAAA,CAAC,qDAAW,CAAK,CAAC,CAClDlB,SAAS,CAACoB,MAAM,GAAK,CAAC,cACxBzB,IAAA,QAAKwB,SAAS,CAAC,iBAAiB,CAAAD,QAAA,cAC9BvB,IAAA,MAAAuB,QAAA,CAAG,8FAAiB,CAAG,CAAC,CACrB,CAAC,cAENvB,IAAA,QAAKwB,SAAS,CAAC,gBAAgB,CAAAD,QAAA,CAC5BlB,SAAS,CAACqB,GAAG,CAACC,OAAO,eACpBzB,KAAA,QAAsBsB,SAAS,CAAC,cAAc,CAAAD,QAAA,eAC5CvB,IAAA,CAACJ,gBAAgB,GAAE,CAAC,cACpBM,KAAA,QAAKsB,SAAS,CAAC,iBAAiB,CAAAD,QAAA,eAC9BvB,IAAA,QAAKwB,SAAS,CAAC,gBAAgB,CAAAD,QAAA,CAC5BI,OAAO,CAACC,MAAM,CAACC,QAAQ,CACrB,CAAC,CACLF,OAAO,CAACG,OAAO,eACd9B,IAAA,QAAKwB,SAAS,CAAC,iBAAiB,CAAAD,QAAA,CAAEI,OAAO,CAACG,OAAO,CAAM,CACxD,CACAH,OAAO,CAACI,IAAI,eACX7B,KAAA,QAAKsB,SAAS,CAAC,cAAc,CAAAD,QAAA,eAC3BrB,KAAA,QAAK8B,KAAK,CAAC,IAAI,CAACC,MAAM,CAAC,IAAI,CAACC,OAAO,CAAC,WAAW,CAACC,IAAI,CAAC,MAAM,CAACC,KAAK,CAAC,4BAA4B,CAACC,KAAK,CAAE,CAAEC,OAAO,CAAE,cAAc,CAAEC,WAAW,CAAE,KAAK,CAAEC,aAAa,CAAE,QAAS,CAAE,CAAAjB,QAAA,eAC7KvB,IAAA,SAAMyC,CAAC,CAAC,qPAAqP,CAACC,MAAM,CAAC,cAAc,CAACC,WAAW,CAAC,GAAG,CAACC,aAAa,CAAC,OAAO,CAACC,cAAc,CAAC,OAAO,CAAC,CAAC,cAClV7C,IAAA,SAAMyC,CAAC,CAAC,YAAY,CAACC,MAAM,CAAC,cAAc,CAACC,WAAW,CAAC,GAAG,CAACC,aAAa,CAAC,OAAO,CAACC,cAAc,CAAC,OAAO,CAAC,CAAC,EACtG,CAAC,CACLlB,OAAO,CAACI,IAAI,CAACe,KAAK,EAChB,CACN,cACD9C,IAAA,QAAKwB,SAAS,CAAC,cAAc,CAAAD,QAAA,CAC1B,GAAI,CAAAwB,IAAI,CAACpB,OAAO,CAACqB,UAAU,CAAC,CAACC,cAAc,CAAC,OAAO,CAAC,CAClD,CAAC,EACH,CAAC,GArBEtB,OAAO,CAACL,EAsBb,CACN,CAAC,CACC,CACN,EACE,CAAC,EACD,CAAC,CACA,CAAC,CAEb,CAAC,CAED,cAAe,CAAAnB,eAAe","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}